import pandas as pd
import numpy as np
from sklearn.multioutput import MultiOutputRegressor
from sklearn.linear_model import LinearRegression
import datetime

############################################################################
# 1) FULL DATA (2023-01-02 -> 2025-01-02)
#    EXACTLY as you provided, stored in 'train_data'.
#    Each row is { 'Date','Open','Close','High','Low','Mid' }.
#    We only use O,H,L,C in the code; 'Mid' is dropped.
############################################################################

train_data = [

    # ===================== 2023-01 =====================
    {'Date':'2023-01-02','Open':130.921,'High':131.051,'Low':130.622,'Close':130.668},
    {'Date':'2023-01-03','Open':130.671,'High':131.398,'Low':129.506,'Close':131.011},
    {'Date':'2023-01-04','Open':131.020,'High':132.714,'Low':129.924,'Close':132.621},
    {'Date':'2023-01-05','Open':132.552,'High':134.050,'Low':131.679,'Close':133.402},
    {'Date':'2023-01-06','Open':133.384,'High':134.775,'Low':131.993,'Close':132.138},
    {'Date':'2023-01-09','Open':131.867,'High':132.655,'Low':131.304,'Close':131.882},
    {'Date':'2023-01-10','Open':131.773,'High':132.473,'Low':131.380,'Close':132.236},
    {'Date':'2023-01-11','Open':132.225,'High':132.873,'Low':131.947,'Close':132.480},
    {'Date':'2023-01-12','Open':132.390,'High':132.485,'Low':128.861,'Close':129.257},
    {'Date':'2023-01-13','Open':129.233,'High':129.406,'Low':127.458,'Close':127.856},
    {'Date':'2023-01-16','Open':127.752,'High':128.863,'Low':127.218,'Close':128.556},
    {'Date':'2023-01-17','Open':128.460,'High':129.155,'Low':127.989,'Close':128.139},
    {'Date':'2023-01-18','Open':128.111,'High':131.574,'Low':127.563,'Close':128.906},
    {'Date':'2023-01-19','Open':128.876,'High':128.888,'Low':127.761,'Close':128.419},
    {'Date':'2023-01-20','Open':128.391,'High':130.612,'Low':128.348,'Close':129.585},
    {'Date':'2023-01-23','Open':129.456,'High':130.888,'Low':129.041,'Close':130.664},
    {'Date':'2023-01-24','Open':130.627,'High':131.117,'Low':129.727,'Close':130.159},
    {'Date':'2023-01-25','Open':130.158,'High':130.583,'Low':129.269,'Close':129.579},
    {'Date':'2023-01-26','Open':129.558,'High':130.618,'Low':129.022,'Close':130.218},
    {'Date':'2023-01-27','Open':130.209,'High':130.272,'Low':129.495,'Close':129.833},
    {'Date':'2023-01-30','Open':129.617,'High':130.568,'Low':129.200,'Close':130.442},
    {'Date':'2023-01-31','Open':130.404,'High':130.530,'Low':129.744,'Close':130.102},

    # ===================== 2023-02 =====================
    {'Date':'2023-02-01','Open':130.067,'High':130.411,'Low':128.532,'Close':128.948},
    {'Date':'2023-02-02','Open':128.937,'High':129.131,'Low':128.080,'Close':128.686},
    {'Date':'2023-02-03','Open':128.677,'High':131.199,'Low':128.328,'Close':131.180},
    {'Date':'2023-02-06','Open':132.292,'High':132.903,'Low':131.506,'Close':132.652},
    {'Date':'2023-02-07','Open':132.626,'High':132.704,'Low':130.476,'Close':131.035},
    {'Date':'2023-02-08','Open':131.058,'High':131.540,'Low':130.597,'Close':131.379},
    {'Date':'2023-02-09','Open':131.362,'High':131.828,'Low':130.344,'Close':131.556},
    {'Date':'2023-02-10','Open':131.564,'High':131.889,'Low':129.803,'Close':131.372},
    {'Date':'2023-02-13','Open':131.335,'High':132.911,'Low':131.335,'Close':132.408},
    {'Date':'2023-02-14','Open':132.373,'High':133.315,'Low':131.500,'Close':133.106},
    {'Date':'2023-02-15','Open':133.135,'High':134.359,'Low':132.544,'Close':134.158},
    {'Date':'2023-02-16','Open':134.136,'High':134.464,'Low':133.605,'Close':133.941},
    {'Date':'2023-02-17','Open':133.958,'High':135.107,'Low':133.912,'Close':134.146},
    {'Date':'2023-02-20','Open':134.202,'High':134.538,'Low':133.923,'Close':134.220},
    {'Date':'2023-02-21','Open':134.208,'High':135.229,'Low':134.145,'Close':135.012},
    {'Date':'2023-02-22','Open':134.996,'High':135.060,'Low':134.365,'Close':134.922},
    {'Date':'2023-02-23','Open':134.855,'High':135.364,'Low':134.487,'Close':134.670},
    {'Date':'2023-02-24','Open':134.684,'High':136.519,'Low':134.052,'Close':136.483},
    {'Date':'2023-02-27','Open':136.404,'High':136.556,'Low':135.917,'Close':136.229},
    {'Date':'2023-02-28','Open':136.219,'High':136.918,'Low':135.730,'Close':136.217},

    # ===================== 2023-03 =====================
    {'Date':'2023-03-01','Open':136.224,'High':136.467,'Low':135.255,'Close':136.217},
    {'Date':'2023-03-02','Open':136.186,'High':137.098,'Low':136.018,'Close':136.752},
    {'Date':'2023-03-03','Open':136.743,'High':136.768,'Low':135.743,'Close':135.826},
    {'Date':'2023-03-06','Open':135.940,'High':136.189,'Low':135.364,'Close':135.929},
    {'Date':'2023-03-07','Open':135.916,'High':137.194,'Low':135.540,'Close':137.153},
    {'Date':'2023-03-08','Open':137.144,'High':137.911,'Low':136.477,'Close':137.376},
    {'Date':'2023-03-09','Open':137.341,'High':137.354,'Low':135.937,'Close':136.114},
    {'Date':'2023-03-10','Open':136.115,'High':136.994,'Low':134.113,'Close':135.060},
    {'Date':'2023-03-13','Open':133.871,'High':135.050,'Low':132.282,'Close':133.193},
    {'Date':'2023-03-14','Open':133.202,'High':134.903,'Low':133.026,'Close':134.230},
    {'Date':'2023-03-15','Open':134.232,'High':135.113,'Low':132.213,'Close':133.313},
    {'Date':'2023-03-16','Open':133.311,'High':133.823,'Low':131.716,'Close':133.583},
    {'Date':'2023-03-17','Open':133.561,'High':133.656,'Low':131.552,'Close':131.820},
    {'Date':'2023-03-20','Open':131.799,'High':132.652,'Low':130.537,'Close':131.309},
    {'Date':'2023-03-21','Open':131.275,'High':132.628,'Low':131.029,'Close':132.420},
    {'Date':'2023-03-22','Open':132.449,'High':133.003,'Low':131.005,'Close':131.342},
    {'Date':'2023-03-23','Open':131.342,'High':131.664,'Low':130.318,'Close':130.803},
    {'Date':'2023-03-24','Open':130.803,'High':130.937,'Low':129.640,'Close':130.725},
    {'Date':'2023-03-27','Open':130.421,'High':131.758,'Low':130.419,'Close':131.563},
    {'Date':'2023-03-28','Open':131.552,'High':131.560,'Low':130.402,'Close':130.916},
    {'Date':'2023-03-29','Open':130.890,'High':132.886,'Low':130.754,'Close':132.833},
    {'Date':'2023-03-30','Open':132.856,'High':132.967,'Low':132.206,'Close':132.699},
    {'Date':'2023-03-31','Open':132.671,'High':133.593,'Low':132.579,'Close':132.819},

    # ===================== 2023-04 =====================
    {'Date':'2023-04-03','Open':133.312,'High':133.757,'Low':132.201,'Close':132.404},
    {'Date':'2023-04-04','Open':132.397,'High':133.170,'Low':131.520,'Close':131.708},
    {'Date':'2023-04-05','Open':131.705,'High':131.844,'Low':130.629,'Close':131.338},
    {'Date':'2023-04-06','Open':131.315,'High':131.904,'Low':130.774,'Close':131.791},
    {'Date':'2023-04-07','Open':131.757,'High':132.380,'Low':131.522,'Close':132.176},
    {'Date':'2023-04-10','Open':132.107,'High':133.870,'Low':131.824,'Close':133.601},
    {'Date':'2023-04-11','Open':133.588,'High':133.806,'Low':132.972,'Close':133.698},
    {'Date':'2023-04-12','Open':133.683,'High':134.047,'Low':132.732,'Close':133.139},
    {'Date':'2023-04-13','Open':133.134,'High':133.395,'Low':132.021,'Close':132.570},
    {'Date':'2023-04-14','Open':132.564,'High':133.838,'Low':132.169,'Close':133.745},
    {'Date':'2023-04-17','Open':133.799,'High':134.573,'Low':133.711,'Close':134.480},
    {'Date':'2023-04-18','Open':134.463,'High':134.705,'Low':133.863,'Close':134.093},
    {'Date':'2023-04-19','Open':134.085,'High':135.139,'Low':133.953,'Close':134.688},
    {'Date':'2023-04-20','Open':134.699,'High':134.973,'Low':134.012,'Close':134.235},
    {'Date':'2023-04-21','Open':134.234,'High':134.490,'Low':133.547,'Close':134.125},
    {'Date':'2023-04-24','Open':133.970,'High':134.731,'Low':133.891,'Close':134.261},
    {'Date':'2023-04-25','Open':134.241,'High':134.476,'Low':133.366,'Close':133.711},
    {'Date':'2023-04-26','Open':133.696,'High':133.944,'Low':133.014,'Close':133.675},
    {'Date':'2023-04-27','Open':133.642,'High':134.194,'Low':133.212,'Close':133.987},
    {'Date':'2023-04-28','Open':133.977,'High':136.562,'Low':133.333,'Close':136.278},

    # ===================== 2023-05 =====================
    {'Date':'2023-05-01','Open':136.112,'High':137.540,'Low':136.112,'Close':137.457},
    {'Date':'2023-05-02','Open':137.455,'High':137.775,'Low':136.312,'Close':136.575},
    {'Date':'2023-05-03','Open':136.545,'High':136.616,'Low':134.825,'Close':134.831},
    {'Date':'2023-05-04','Open':134.742,'High':134.878,'Low':133.497,'Close':134.260},
    {'Date':'2023-05-05','Open':134.266,'High':135.126,'Low':133.883,'Close':134.832},
    {'Date':'2023-05-08','Open':134.802,'High':135.296,'Low':134.640,'Close':135.106},
    {'Date':'2023-05-09','Open':135.108,'High':135.362,'Low':134.721,'Close':135.229},
    {'Date':'2023-05-10','Open':135.223,'High':135.471,'Low':134.111,'Close':134.377},
    {'Date':'2023-05-11','Open':134.356,'High':134.844,'Low':133.743,'Close':134.561},
    {'Date':'2023-05-12','Open':134.547,'High':135.752,'Low':134.400,'Close':135.723},
    {'Date':'2023-05-15','Open':135.628,'High':136.324,'Low':135.619,'Close':136.106},
    {'Date':'2023-05-16','Open':136.091,'High':136.682,'Low':135.670,'Close':136.396},
    {'Date':'2023-05-17','Open':136.367,'High':137.707,'Low':136.302,'Close':137.610},
    {'Date':'2023-05-18','Open':137.693,'High':138.745,'Low':137.286,'Close':138.703},
    {'Date':'2023-05-19','Open':138.694,'High':138.722,'Low':137.424,'Close':137.964},
    {'Date':'2023-05-22','Open':137.986,'High':138.688,'Low':137.491,'Close':138.584},
    {'Date':'2023-05-23','Open':138.579,'High':138.910,'Low':138.242,'Close':138.586},
    {'Date':'2023-05-24','Open':138.564,'High':139.471,'Low':138.229,'Close':139.452},
    {'Date':'2023-05-25','Open':139.461,'High':140.227,'Low':138.811,'Close':140.042},
    {'Date':'2023-05-26','Open':140.028,'High':140.723,'Low':139.494,'Close':140.592},
    {'Date':'2023-05-29','Open':140.567,'High':140.916,'Low':140.111,'Close':140.438},
    {'Date':'2023-05-30','Open':140.431,'High':140.930,'Low':139.568,'Close':139.775},
    {'Date':'2023-05-31','Open':139.773,'High':140.411,'Low':139.233,'Close':139.307},

    # ===================== 2023-06 =====================
    {'Date':'2023-06-01','Open':139.328,'High':139.950,'Low':138.433,'Close':138.806},
    {'Date':'2023-06-02','Open':138.780,'High':140.068,'Low':138.604,'Close':139.964},
    {'Date':'2023-06-05','Open':139.947,'High':140.453,'Low':139.250,'Close':139.563},
    {'Date':'2023-06-06','Open':139.569,'High':139.992,'Low':139.095,'Close':139.661},
    {'Date':'2023-06-07','Open':139.620,'High':140.244,'Low':139.022,'Close':140.181},
    {'Date':'2023-06-08','Open':140.160,'High':140.220,'Low':138.807,'Close':138.920},
    {'Date':'2023-06-09','Open':138.911,'High':139.724,'Low':138.758,'Close':139.373},
    {'Date':'2023-06-12','Open':139.262,'High':139.766,'Low':139.062,'Close':139.599},
    {'Date':'2023-06-13','Open':139.596,'High':140.309,'Low':139.010,'Close':140.229},
    {'Date':'2023-06-14','Open':140.211,'High':140.273,'Low':139.282,'Close':140.110},
    {'Date':'2023-06-15','Open':140.068,'High':141.505,'Low':139.938,'Close':140.280},
    {'Date':'2023-06-16','Open':140.259,'High':141.910,'Low':139.851,'Close':141.882},
    {'Date':'2023-06-19','Open':141.662,'High':142.001,'Low':141.440,'Close':141.987},
    {'Date':'2023-06-20','Open':141.978,'High':142.249,'Low':141.213,'Close':141.441},
    {'Date':'2023-06-21','Open':141.457,'High':142.371,'Low':141.280,'Close':141.877},
    {'Date':'2023-06-22','Open':141.751,'High':143.227,'Low':141.609,'Close':143.109},
    {'Date':'2023-06-23','Open':143.085,'High':143.870,'Low':142.678,'Close':143.696},
    {'Date':'2023-06-26','Open':143.476,'High':143.712,'Low':142.938,'Close':143.502},
    {'Date':'2023-06-27','Open':143.500,'High':144.175,'Low':143.282,'Close':144.062},
    {'Date':'2023-06-28','Open':144.062,'High':144.617,'Low':143.729,'Close':144.481},
    {'Date':'2023-06-29','Open':144.478,'High':144.898,'Low':144.130,'Close':144.733},
    {'Date':'2023-06-30','Open':144.733,'High':145.069,'Low':144.200,'Close':144.297},

    # ===================== 2023-07 =====================
    {'Date':'2023-07-03','Open':144.351,'High':144.911,'Low':143.981,'Close':144.637},
    {'Date':'2023-07-04','Open':144.643,'High':144.699,'Low':144.204,'Close':144.442},
    {'Date':'2023-07-05','Open':144.445,'High':144.733,'Low':144.078,'Close':144.643},
    {'Date':'2023-07-06','Open':144.643,'High':144.652,'Low':143.553,'Close':144.055},
    {'Date':'2023-07-07','Open':144.059,'High':144.196,'Low':142.068,'Close':142.088},
    {'Date':'2023-07-10','Open':142.121,'High':143.005,'Low':141.275,'Close':141.299},
    {'Date':'2023-07-11','Open':141.299,'High':141.457,'Low':140.159,'Close':140.353},
    {'Date':'2023-07-12','Open':140.357,'High':140.375,'Low':138.153,'Close':138.491},
    {'Date':'2023-07-13','Open':138.483,'High':138.956,'Low':137.921,'Close':138.038},
    {'Date':'2023-07-14','Open':138.028,'High':139.155,'Low':137.233,'Close':138.810},
    {'Date':'2023-07-17','Open':138.690,'High':139.405,'Low':137.994,'Close':138.703},
    {'Date':'2023-07-18','Open':138.705,'High':139.132,'Low':137.682,'Close':138.822},
    {'Date':'2023-07-19','Open':138.824,'High':139.992,'Low':138.749,'Close':139.634},
    {'Date':'2023-07-20','Open':139.541,'High':140.497,'Low':139.107,'Close':140.065},
    {'Date':'2023-07-21','Open':140.068,'High':141.952,'Low':139.747,'Close':141.778},
    {'Date':'2023-07-24','Open':141.631,'High':141.810,'Low':140.739,'Close':141.468},
    {'Date':'2023-07-25','Open':141.466,'High':141.743,'Low':140.849,'Close':140.899},
    {'Date':'2023-07-26','Open':141.008,'High':141.182,'Low':139.921,'Close':140.235},
    {'Date':'2023-07-27','Open':140.169,'High':141.320,'Low':138.765,'Close':139.491},
    {'Date':'2023-07-28','Open':139.455,'High':141.177,'Low':138.060,'Close':141.158},
    {'Date':'2023-07-31','Open':140.945,'High':142.688,'Low':140.688,'Close':142.276},

    # ===================== 2023-08 =====================
    {'Date':'2023-08-01','Open':142.287,'High':143.542,'Low':142.204,'Close':143.320},
    {'Date':'2023-08-02','Open':143.317,'High':143.475,'Low':142.229,'Close':143.321},
    {'Date':'2023-08-03','Open':143.323,'High':143.888,'Low':142.064,'Close':142.560},
    {'Date':'2023-08-04','Open':142.535,'High':142.895,'Low':141.549,'Close':141.702},
    {'Date':'2023-08-07','Open':141.634,'High':142.583,'Low':141.510,'Close':142.478},
    {'Date':'2023-08-08','Open':142.489,'High':143.490,'Low':142.397,'Close':143.364},
    {'Date':'2023-08-09','Open':143.358,'High':143.748,'Low':142.996,'Close':143.713},
    {'Date':'2023-08-10','Open':143.714,'High':144.814,'Low':143.280,'Close':144.735},
    {'Date':'2023-08-11','Open':144.735,'High':144.999,'Low':144.416,'Close':144.942},
    {'Date':'2023-08-14','Open':144.899,'High':145.577,'Low':144.651,'Close':145.540},
    {'Date':'2023-08-15','Open':145.544,'High':145.864,'Low':145.101,'Close':145.561},
    {'Date':'2023-08-16','Open':145.556,'High':146.406,'Low':145.307,'Close':146.342},
    {'Date':'2023-08-17','Open':146.333,'High':146.561,'Low':145.621,'Close':145.824},
    {'Date':'2023-08-18','Open':145.820,'High':145.862,'Low':144.927,'Close':145.373},
    {'Date':'2023-08-21','Open':145.303,'High':146.404,'Low':145.140,'Close':146.210},
    {'Date':'2023-08-22','Open':146.207,'High':146.400,'Low':145.497,'Close':145.880},
    {'Date':'2023-08-23','Open':145.880,'High':145.882,'Low':144.538,'Close':144.822},
    {'Date':'2023-08-24','Open':144.813,'High':145.961,'Low':144.602,'Close':145.814},
    {'Date':'2023-08-25','Open':145.814,'High':146.635,'Low':145.716,'Close':146.395},
    {'Date':'2023-08-28','Open':146.430,'High':146.745,'Low':146.273,'Close':146.529},
    {'Date':'2023-08-29','Open':146.526,'High':147.375,'Low':145.667,'Close':145.868},
    {'Date':'2023-08-30','Open':145.868,'High':146.537,'Low':145.559,'Close':146.219},
    {'Date':'2023-08-31','Open':146.218,'High':146.241,'Low':145.348,'Close':145.522},

    # ===================== 2023-09 =====================
    {'Date':'2023-09-01','Open':145.522,'High':146.294,'Low':144.439,'Close':146.212},
    {'Date':'2023-09-04','Open':146.154,'High':146.498,'Low':146.021,'Close':146.450},
    {'Date':'2023-09-05','Open':146.468,'High':147.801,'Low':146.269,'Close':147.699},
    {'Date':'2023-09-06','Open':147.708,'High':147.817,'Low':147.016,'Close':147.653},
    {'Date':'2023-09-07','Open':147.594,'High':147.873,'Low':147.043,'Close':147.267},
    {'Date':'2023-09-08','Open':147.281,'High':147.869,'Low':146.583,'Close':147.788},
    {'Date':'2023-09-11','Open':146.997,'High':147.260,'Low':145.899,'Close':146.561},
    {'Date':'2023-09-12','Open':146.577,'High':147.234,'Low':146.434,'Close':147.082},
    {'Date':'2023-09-13','Open':147.075,'High':147.745,'Low':147.011,'Close':147.447},
    {'Date':'2023-09-14','Open':147.452,'High':147.568,'Low':147.015,'Close':147.467},
    {'Date':'2023-09-15','Open':147.463,'High':147.950,'Low':147.338,'Close':147.828},
    {'Date':'2023-09-18','Open':147.688,'High':147.877,'Low':147.553,'Close':147.588},
    {'Date':'2023-09-19','Open':147.605,'High':147.921,'Low':147.502,'Close':147.852},
    {'Date':'2023-09-20','Open':147.852,'High':148.352,'Low':147.473,'Close':148.323},
    {'Date':'2023-09-21','Open':148.338,'High':148.461,'Low':147.320,'Close':147.557},
    {'Date':'2023-09-22','Open':147.588,'High':148.419,'Low':147.504,'Close':148.365},
    {'Date':'2023-09-25','Open':148.176,'High':148.961,'Low':148.176,'Close':148.856},
    {'Date':'2023-09-26','Open':148.870,'High':149.186,'Low':148.702,'Close':149.052},
    {'Date':'2023-09-27','Open':148.973,'High':149.708,'Low':148.858,'Close':149.626},
    {'Date':'2023-09-28','Open':149.486,'High':149.637,'Low':149.144,'Close':149.304},
    {'Date':'2023-09-29','Open':149.236,'High':149.503,'Low':148.523,'Close':149.325},

    # ===================== 2023-10 =====================
    {'Date':'2023-10-02','Open':149.605,'High':149.875,'Low':149.404,'Close':149.852},
    {'Date':'2023-10-03','Open':149.842,'High':150.158,'Low':147.291,'Close':148.978},
    {'Date':'2023-10-04','Open':148.987,'High':149.318,'Low':148.732,'Close':149.107},
    {'Date':'2023-10-05','Open':149.111,'High':149.118,'Low':148.254,'Close':148.497},
    {'Date':'2023-10-06','Open':148.500,'High':149.535,'Low':148.294,'Close':149.255},
    {'Date':'2023-10-09','Open':149.040,'High':149.234,'Low':148.430,'Close':148.492},
    {'Date':'2023-10-10','Open':148.493,'High':149.097,'Low':148.161,'Close':148.706},
    {'Date':'2023-10-11','Open':148.675,'High':149.323,'Low':148.424,'Close':149.155},
    {'Date':'2023-10-12','Open':149.125,'High':149.828,'Low':148.955,'Close':149.802},
    {'Date':'2023-10-13','Open':149.768,'High':149.828,'Low':149.453,'Close':149.563},
    {'Date':'2023-10-16','Open':149.342,'High':149.762,'Low':149.325,'Close':149.504},
    {'Date':'2023-10-17','Open':149.491,'High':149.848,'Low':148.959,'Close':149.792},
    {'Date':'2023-10-18','Open':149.803,'High':149.931,'Low':149.481,'Close':149.914},
    {'Date':'2023-10-19','Open':149.894,'High':149.959,'Low':149.663,'Close':149.776},
    {'Date':'2023-10-20','Open':149.712,'High':149.989,'Low':149.632,'Close':149.845},
    {'Date':'2023-10-23','Open':149.780,'High':149.986,'Low':149.551,'Close':149.692},
    {'Date':'2023-10-24','Open':149.707,'High':149.946,'Low':149.317,'Close':149.895},
    {'Date':'2023-10-25','Open':149.913,'High':150.313,'Low':149.791,'Close':150.231},
    {'Date':'2023-10-26','Open':150.177,'High':150.775,'Low':149.839,'Close':150.362},
    {'Date':'2023-10-27','Open':150.375,'High':150.408,'Low':149.456,'Close':149.604},
    {'Date':'2023-10-30','Open':149.496,'High':149.851,'Low':148.802,'Close':149.061},
    {'Date':'2023-10-31','Open':149.018,'High':151.706,'Low':149.014,'Close':151.618},

    # ===================== 2023-11 =====================
    {'Date':'2023-11-01','Open':151.604,'High':151.624,'Low':150.659,'Close':150.902},
    {'Date':'2023-11-02','Open':150.889,'High':150.924,'Low':149.842,'Close':150.435},
    {'Date':'2023-11-03','Open':150.435,'High':150.513,'Low':149.187,'Close':149.352},
    {'Date':'2023-11-06','Open':149.302,'High':150.074,'Low':149.299,'Close':150.068},
    {'Date':'2023-11-07','Open':150.069,'High':150.689,'Low':149.862,'Close':150.322},
    {'Date':'2023-11-08','Open':150.294,'High':151.053,'Low':150.288,'Close':150.960},
    {'Date':'2023-11-09','Open':150.972,'High':151.384,'Low':150.766,'Close':151.342},
    {'Date':'2023-11-10','Open':151.331,'High':151.598,'Low':151.219,'Close':151.521},
    {'Date':'2023-11-13','Open':151.417,'High':151.906,'Low':151.198,'Close':151.715},
    {'Date':'2023-11-14','Open':151.718,'High':151.782,'Low':150.150,'Close':150.376},
    {'Date':'2023-11-15','Open':150.369,'High':151.418,'Low':150.048,'Close':151.362},
    {'Date':'2023-11-16','Open':151.210,'High':151.427,'Low':150.283,'Close':150.711},
    {'Date':'2023-11-17','Open':150.716,'High':150.770,'Low':149.192,'Close':149.576},
    {'Date':'2023-11-20','Open':149.503,'High':149.986,'Low':148.100,'Close':148.339},
    {'Date':'2023-11-21','Open':148.348,'High':148.591,'Low':147.150,'Close':148.385},
    {'Date':'2023-11-22','Open':148.289,'High':149.746,'Low':148.014,'Close':149.520},
    {'Date':'2023-11-23','Open':149.499,'High':149.685,'Low':148.887,'Close':149.547},
    {'Date':'2023-11-24','Open':149.525,'High':149.708,'Low':149.194,'Close':149.408},
    {'Date':'2023-11-27','Open':149.366,'High':149.670,'Low':148.541,'Close':148.668},
    {'Date':'2023-11-28','Open':148.667,'High':148.828,'Low':147.320,'Close':147.464},
    {'Date':'2023-11-29','Open':147.483,'High':147.902,'Low':146.669,'Close':147.231},
    {'Date':'2023-11-30','Open':147.232,'High':148.509,'Low':146.838,'Close':148.179},

    # ===================== 2023-12 =====================
    {'Date':'2023-12-01','Open':148.179,'High':148.348,'Low':146.660,'Close':146.788},
    {'Date':'2023-12-04','Open':146.682,'High':147.452,'Low':146.226,'Close':147.203},
    {'Date':'2023-12-05','Open':147.132,'High':147.387,'Low':146.558,'Close':147.134},
    {'Date':'2023-12-06','Open':147.139,'High':147.497,'Low':146.897,'Close':147.293},
    {'Date':'2023-12-07','Open':147.307,'High':147.309,'Low':141.633,'Close':144.093},
    {'Date':'2023-12-08','Open':144.120,'High':145.218,'Low':142.496,'Close':144.900},
    {'Date':'2023-12-11','Open':144.934,'High':146.586,'Low':144.813,'Close':146.147},
    {'Date':'2023-12-12','Open':146.148,'High':146.176,'Low':144.735,'Close':145.431},
    {'Date':'2023-12-13','Open':145.500,'High':145.992,'Low':142.638,'Close':142.884},
    {'Date':'2023-12-14','Open':142.885,'High':142.912,'Low':140.959,'Close':141.855},
    {'Date':'2023-12-15','Open':141.848,'High':142.466,'Low':141.427,'Close':142.099},
    {'Date':'2023-12-18','Open':142.024,'High':143.158,'Low':142.013,'Close':142.761},
    {'Date':'2023-12-19','Open':142.725,'High':144.958,'Low':142.240,'Close':143.814},
    {'Date':'2023-12-20','Open':143.816,'High':144.096,'Low':143.262,'Close':143.550},
    {'Date':'2023-12-21','Open':143.571,'High':143.571,'Low':142.043,'Close':142.101},
    {'Date':'2023-12-22','Open':142.064,'High':142.663,'Low':141.858,'Close':142.389},
    {'Date':'2023-12-25','Open':142.345,'High':142.485,'Low':142.216,'Close':142.409},
    {'Date':'2023-12-26','Open':142.277,'High':142.635,'Low':142.090,'Close':142.395},
    {'Date':'2023-12-27','Open':142.394,'High':142.846,'Low':141.542,'Close':141.812},
    {'Date':'2023-12-28','Open':141.818,'High':141.824,'Low':140.249,'Close':141.368},
    {'Date':'2023-12-29','Open':141.338,'High':141.913,'Low':140.791,'Close':140.991},

    # ===================== 2024-01 =====================
    {'Date':'2024-01-02','Open':140.830,'High':142.216,'Low':140.807,'Close':141.970},
    {'Date':'2024-01-03','Open':141.829,'High':143.731,'Low':141.771,'Close':143.288},
    {'Date':'2024-01-04','Open':143.289,'High':144.852,'Low':142.850,'Close':144.622},
    {'Date':'2024-01-05','Open':144.518,'High':145.979,'Low':143.806,'Close':144.558},
    {'Date':'2024-01-08','Open':144.441,'High':144.918,'Low':143.662,'Close':144.220},
    {'Date':'2024-01-09','Open':144.195,'High':144.620,'Low':143.417,'Close':144.464},
    {'Date':'2024-01-10','Open':144.440,'High':145.830,'Low':144.316,'Close':145.749},
    {'Date':'2024-01-11','Open':145.736,'High':146.417,'Low':144.953,'Close':145.274},
    {'Date':'2024-01-12','Open':145.256,'High':145.568,'Low':144.349,'Close':144.906},
    {'Date':'2024-01-15','Open':144.849,'High':145.942,'Low':144.749,'Close':145.708},
    {'Date':'2024-01-16','Open':145.709,'High':147.311,'Low':145.582,'Close':147.182},
    {'Date':'2024-01-17','Open':147.182,'High':148.528,'Low':147.042,'Close':148.154},
    {'Date':'2024-01-18','Open':148.141,'High':148.302,'Low':147.654,'Close':148.154},
    {'Date':'2024-01-19','Open':148.154,'High':148.804,'Low':147.835,'Close':148.112},
    {'Date':'2024-01-22','Open':148.212,'High':148.304,'Low':147.616,'Close':148.092},
    {'Date':'2024-01-23','Open':148.093,'High':148.693,'Low':146.977,'Close':148.321},
    {'Date':'2024-01-24','Open':148.319,'High':148.396,'Low':146.646,'Close':147.497},
    {'Date':'2024-01-25','Open':147.489,'High':147.949,'Low':147.083,'Close':147.652},
    {'Date':'2024-01-26','Open':147.634,'High':148.204,'Low':147.422,'Close':148.150},
    {'Date':'2024-01-29','Open':148.063,'High':148.332,'Low':147.246,'Close':147.487},
    {'Date':'2024-01-30','Open':147.496,'High':147.928,'Low':147.086,'Close':147.594},
    {'Date':'2024-01-31','Open':147.592,'High':147.901,'Low':146.005,'Close':146.894},

    # ===================== 2024-02 =====================
    {'Date':'2024-02-01','Open':146.890,'High':147.114,'Low':145.895,'Close':146.412},
    {'Date':'2024-02-02','Open':146.421,'High':148.586,'Low':146.198,'Close':148.341},
    {'Date':'2024-02-05','Open':148.408,'High':148.895,'Low':148.264,'Close':148.669},
    {'Date':'2024-02-06','Open':148.669,'High':148.788,'Low':147.815,'Close':147.933},
    {'Date':'2024-02-07','Open':147.935,'High':148.258,'Low':147.617,'Close':148.177},
    {'Date':'2024-02-08','Open':148.173,'High':149.479,'Low':147.928,'Close':149.308},
    {'Date':'2024-02-09','Open':149.309,'High':149.576,'Low':149.008,'Close':149.251},
    {'Date':'2024-02-12','Open':149.210,'High':149.478,'Low':148.926,'Close':149.332},
    {'Date':'2024-02-13','Open':149.334,'High':150.881,'Low':149.193,'Close':150.818},
    {'Date':'2024-02-14','Open':150.798,'High':150.806,'Low':150.340,'Close':150.547},
    {'Date':'2024-02-15','Open':150.544,'High':150.573,'Low':149.531,'Close':149.899},
    {'Date':'2024-02-16','Open':149.894,'High':150.646,'Low':149.823,'Close':150.176},
    {'Date':'2024-02-19','Open':150.080,'High':150.190,'Low':149.871,'Close':150.109},
    {'Date':'2024-02-20','Open':150.108,'High':150.436,'Low':149.681,'Close':149.996},
    {'Date':'2024-02-21','Open':149.994,'High':150.390,'Low':149.849,'Close':150.289},
    {'Date':'2024-02-22','Open':150.302,'High':150.686,'Low':150.015,'Close':150.520},
    {'Date':'2024-02-23','Open':150.524,'High':150.768,'Low':150.292,'Close':150.504},
    {'Date':'2024-02-26','Open':150.493,'High':150.835,'Low':150.239,'Close':150.676},
    {'Date':'2024-02-27','Open':150.683,'High':150.704,'Low':150.074,'Close':150.486},
    {'Date':'2024-02-28','Open':150.502,'High':150.843,'Low':150.369,'Close':150.679},
    {'Date':'2024-02-29','Open':150.684,'High':150.692,'Low':149.205,'Close':149.955},

    # ===================== 2024-03 =====================
    {'Date':'2024-03-01','Open':149.968,'High':150.721,'Low':149.903,'Close':150.062},
    {'Date':'2024-03-04','Open':149.985,'High':150.568,'Low':149.836,'Close':150.502},
    {'Date':'2024-03-05','Open':150.523,'High':150.541,'Low':149.702,'Close':150.049},
    {'Date':'2024-03-06','Open':150.046,'High':150.081,'Low':149.090,'Close':149.366},
    {'Date':'2024-03-07','Open':149.367,'High':149.387,'Low':147.578,'Close':148.022},
    {'Date':'2024-03-08','Open':148.040,'High':148.114,'Low':146.480,'Close':147.050},
    {'Date':'2024-03-11','Open':147.030,'High':147.147,'Low':146.483,'Close':146.953},
    {'Date':'2024-03-12','Open':146.952,'High':148.175,'Low':146.615,'Close':147.607},
    {'Date':'2024-03-13','Open':147.623,'High':148.043,'Low':147.232,'Close':147.623},
    {'Date':'2024-03-14','Open':147.622,'High':148.356,'Low':147.437,'Close':148.281},
    {'Date':'2024-03-15','Open':148.281,'High':149.163,'Low':148.031,'Close':149.005},
    {'Date':'2024-03-18','Open':149.050,'High':149.329,'Low':148.906,'Close':149.100},
    {'Date':'2024-03-19','Open':149.094,'High':150.962,'Low':149.000,'Close':150.770},
    {'Date':'2024-03-20','Open':150.769,'High':151.817,'Low':150.715,'Close':151.191},
    {'Date':'2024-03-21','Open':151.190,'High':151.753,'Low':150.261,'Close':151.583},
    {'Date':'2024-03-22','Open':151.585,'High':151.860,'Low':151.001,'Close':151.415},
    {'Date':'2024-03-25','Open':151.425,'High':151.542,'Low':151.051,'Close':151.399},
    {'Date':'2024-03-26','Open':151.398,'High':151.603,'Low':151.207,'Close':151.508},
    {'Date':'2024-03-27','Open':151.508,'High':151.968,'Low':151.025,'Close':151.256},
    {'Date':'2024-03-28','Open':151.254,'High':151.542,'Low':151.148,'Close':151.371},
    {'Date':'2024-03-29','Open':151.369,'High':151.497,'Low':151.173,'Close':151.321},

    # ===================== 2024-04 =====================
    {'Date':'2024-04-01','Open':151.310,'High':151.770,'Low':151.218,'Close':151.637},
    {'Date':'2024-04-02','Open':151.642,'High':151.802,'Low':151.462,'Close':151.549},
    {'Date':'2024-04-03','Open':151.531,'High':151.954,'Low':151.439,'Close':151.684},
    {'Date':'2024-04-04','Open':151.670,'High':151.770,'Low':151.119,'Close':151.332},
    {'Date':'2024-04-05','Open':151.336,'High':151.750,'Low':150.810,'Close':151.617},
    {'Date':'2024-04-08','Open':151.640,'High':151.942,'Low':151.543,'Close':151.810},
    {'Date':'2024-04-09','Open':151.817,'High':151.935,'Low':151.568,'Close':151.765},
    {'Date':'2024-04-10','Open':151.759,'High':153.235,'Low':151.650,'Close':153.143},
    {'Date':'2024-04-11','Open':153.153,'High':153.317,'Low':152.757,'Close':153.249},
    {'Date':'2024-04-12','Open':153.268,'High':153.383,'Low':152.592,'Close':153.262},
    {'Date':'2024-04-15','Open':153.050,'High':154.442,'Low':152.951,'Close':154.264},
    {'Date':'2024-04-16','Open':154.268,'High':154.784,'Low':153.893,'Close':154.690},
    {'Date':'2024-04-17','Open':154.695,'High':154.732,'Low':154.155,'Close':154.372},
    {'Date':'2024-04-18','Open':154.374,'High':154.676,'Low':153.957,'Close':154.632},
    {'Date':'2024-04-19','Open':154.612,'High':154.671,'Low':153.588,'Close':154.625},
    {'Date':'2024-04-22','Open':154.479,'High':154.851,'Low':154.356,'Close':154.835},
    {'Date':'2024-04-23','Open':154.835,'High':154.875,'Low':154.556,'Close':154.822},
    {'Date':'2024-04-24','Open':154.825,'High':155.371,'Low':154.728,'Close':155.338},
    {'Date':'2024-04-25','Open':155.316,'High':155.745,'Low':155.193,'Close':155.643},
    {'Date':'2024-04-26','Open':155.610,'High':158.440,'Low':154.963,'Close':158.333},
    {'Date':'2024-04-29','Open':157.870,'High':160.222,'Low':154.530,'Close':156.338},
    {'Date':'2024-04-30','Open':156.329,'High':157.841,'Low':156.051,'Close':157.789},

    # ===================== 2024-05 =====================
    {'Date':'2024-05-01','Open':157.780,'High':157.986,'Low':152.996,'Close':154.614},
    {'Date':'2024-05-02','Open':154.575,'High':156.279,'Low':153.053,'Close':153.697},
    {'Date':'2024-05-03','Open':153.592,'High':153.778,'Low':151.860,'Close':152.946},
    {'Date':'2024-05-06','Open':152.920,'High':154.005,'Low':152.747,'Close':153.870},
    {'Date':'2024-05-07','Open':153.901,'High':154.745,'Low':153.840,'Close':154.683},
    {'Date':'2024-05-08','Open':154.684,'High':155.678,'Low':154.507,'Close':155.523},
    {'Date':'2024-05-09','Open':155.546,'High':155.952,'Low':155.159,'Close':155.469},
    {'Date':'2024-05-10','Open':155.474,'High':155.904,'Low':155.262,'Close':155.751},
    {'Date':'2024-05-13','Open':155.742,'High':156.245,'Low':155.507,'Close':156.185},
    {'Date':'2024-05-14','Open':156.201,'High':156.790,'Low':156.011,'Close':156.413},
    {'Date':'2024-05-15','Open':156.389,'High':156.558,'Low':154.688,'Close':154.865},
    {'Date':'2024-05-16','Open':154.856,'High':155.528,'Low':153.597,'Close':155.359},
    {'Date':'2024-05-17','Open':155.363,'High':155.979,'Low':155.248,'Close':155.613},
    {'Date':'2024-05-20','Open':155.610,'High':156.300,'Low':155.497,'Close':156.236},
    {'Date':'2024-05-21','Open':156.222,'High':156.544,'Low':155.847,'Close':156.148},
    {'Date':'2024-05-22','Open':156.141,'High':156.832,'Low':156.092,'Close':156.765},
    {'Date':'2024-05-23','Open':156.769,'High':157.194,'Low':156.526,'Close':156.898},
    {'Date':'2024-05-24','Open':156.901,'High':157.143,'Low':156.822,'Close':156.987},
    {'Date':'2024-05-27','Open':156.940,'High':157.010,'Low':156.662,'Close':156.879},
    {'Date':'2024-05-28','Open':156.808,'High':157.198,'Low':156.580,'Close':157.127},
    {'Date':'2024-05-29','Open':157.130,'High':157.708,'Low':156.894,'Close':157.627},
    {'Date':'2024-05-30','Open':157.626,'High':157.667,'Low':156.372,'Close':156.768},
    {'Date':'2024-05-31','Open':156.795,'High':157.365,'Low':156.557,'Close':157.220},

    # ===================== 2024-06 =====================
    {'Date':'2024-06-03','Open':157.180,'High':157.472,'Low':155.949,'Close':156.047},
    {'Date':'2024-06-04','Open':156.049,'High':156.484,'Low':154.544,'Close':154.875},
    {'Date':'2024-06-05','Open':154.873,'High':156.482,'Low':154.783,'Close':156.065},
    {'Date':'2024-06-06','Open':156.075,'High':156.444,'Low':155.366,'Close':155.591},
    {'Date':'2024-06-07','Open':155.528,'High':157.074,'Low':155.123,'Close':156.762},
    {'Date':'2024-06-10','Open':156.680,'High':157.194,'Low':156.518,'Close':156.992},
    {'Date':'2024-06-11','Open':156.994,'High':157.402,'Low':156.806,'Close':157.115},
    {'Date':'2024-06-12','Open':157.113,'High':157.370,'Low':155.718,'Close':156.703},
    {'Date':'2024-06-13','Open':156.703,'High':157.312,'Low':156.561,'Close':157.017},
    {'Date':'2024-06-14','Open':157.003,'High':158.255,'Low':156.810,'Close':157.355},
    {'Date':'2024-06-17','Open':157.295,'High':157.958,'Low':157.155,'Close':157.715},
    {'Date':'2024-06-18','Open':157.702,'High':158.228,'Low':157.516,'Close':157.847},
    {'Date':'2024-06-19','Open':157.840,'High':158.129,'Low':157.603,'Close':158.075},
    {'Date':'2024-06-20','Open':158.068,'High':158.945,'Low':157.920,'Close':158.926},
    {'Date':'2024-06-21','Open':158.923,'High':159.826,'Low':158.670,'Close':159.783},
    {'Date':'2024-06-24','Open':159.760,'High':159.928,'Low':158.737,'Close':159.604},
    {'Date':'2024-06-25','Open':159.589,'High':159.756,'Low':159.189,'Close':159.679},
    {'Date':'2024-06-26','Open':159.654,'High':160.865,'Low':159.607,'Close':160.805},
    {'Date':'2024-06-27','Open':160.768,'High':160.824,'Low':160.285,'Close':160.734},
    {'Date':'2024-06-28','Open':160.749,'High':161.282,'Low':160.261,'Close':160.826},

    # ===================== 2024-07 =====================
    {'Date':'2024-07-01','Open':160.760,'High':161.727,'Low':160.699,'Close':161.458},
    {'Date':'2024-07-02','Open':161.432,'High':161.743,'Low':161.341,'Close':161.587},
    {'Date':'2024-07-03','Open':161.422,'High':161.950,'Low':160.773,'Close':161.678},
    {'Date':'2024-07-04','Open':161.662,'High':161.693,'Low':160.946,'Close':161.266},
    {'Date':'2024-07-05','Open':161.256,'High':161.394,'Low':160.331,'Close':160.739},
    {'Date':'2024-07-08','Open':160.750,'High':161.118,'Low':160.261,'Close':160.815},
    {'Date':'2024-07-09','Open':160.787,'High':161.516,'Low':160.729,'Close':161.321},
    {'Date':'2024-07-10','Open':161.308,'High':161.804,'Low':161.241,'Close':161.672},
    {'Date':'2024-07-11','Open':161.665,'High':161.759,'Low':157.410,'Close':158.842},
    {'Date':'2024-07-12','Open':158.857,'High':159.446,'Low':157.371,'Close':157.861},
    {'Date':'2024-07-15','Open':158.073,'High':158.418,'Low':157.150,'Close':158.083},
    {'Date':'2024-07-16','Open':158.017,'High':158.854,'Low':157.917,'Close':158.350},
    {'Date':'2024-07-17','Open':158.332,'High':158.615,'Low':156.063,'Close':156.203},
    {'Date':'2024-07-18','Open':156.147,'High':157.400,'Low':155.370,'Close':157.356},
    {'Date':'2024-07-19','Open':157.357,'High':157.862,'Low':156.966,'Close':157.445},
    {'Date':'2024-07-22','Open':157.430,'High':157.613,'Low':156.285,'Close':157.000},
    {'Date':'2024-07-23','Open':157.008,'High':157.101,'Low':155.542,'Close':155.565},
    {'Date':'2024-07-24','Open':155.582,'High':155.991,'Low':153.106,'Close':153.850},
    {'Date':'2024-07-25','Open':153.852,'High':154.315,'Low':151.942,'Close':153.937},
    {'Date':'2024-07-26','Open':153.938,'High':154.737,'Low':153.110,'Close':153.723},
    {'Date':'2024-07-29','Open':153.675,'High':154.353,'Low':153.014,'Close':154.000},
    {'Date':'2024-07-30','Open':153.994,'High':155.214,'Low':152.659,'Close':152.734},
    {'Date':'2024-07-31','Open':152.762,'High':153.920,'Low':149.609,'Close':149.969},

    # ===================== 2024-08 =====================
    {'Date':'2024-08-01','Open':149.944,'High':150.888,'Low':148.512,'Close':149.342},
    {'Date':'2024-08-02','Open':149.361,'High':149.771,'Low':146.418,'Close':146.485},
    {'Date':'2024-08-05','Open':146.382,'High':146.564,'Low':141.689,'Close':144.183},
    {'Date':'2024-08-06','Open':144.182,'High':146.373,'Low':143.627,'Close':144.291},
    {'Date':'2024-08-07','Open':144.320,'High':147.897,'Low':144.237,'Close':146.658},
    {'Date':'2024-08-08','Open':146.659,'High':147.541,'Low':145.431,'Close':147.235},
    {'Date':'2024-08-09','Open':147.231,'High':147.813,'Low':146.271,'Close':146.586},
    {'Date':'2024-08-12','Open':146.543,'High':148.220,'Low':146.421,'Close':147.183},
    {'Date':'2024-08-13','Open':147.189,'High':147.945,'Low':146.597,'Close':146.820},
    {'Date':'2024-08-14','Open':146.809,'High':147.574,'Low':146.072,'Close':147.304},
    {'Date':'2024-08-15','Open':147.299,'High':149.376,'Low':147.053,'Close':149.267},
    {'Date':'2024-08-16','Open':149.257,'High':149.342,'Low':147.567,'Close':147.590},
    {'Date':'2024-08-19','Open':147.577,'High':148.050,'Low':145.187,'Close':146.565},
    {'Date':'2024-08-20','Open':146.566,'High':147.342,'Low':145.194,'Close':145.246},
    {'Date':'2024-08-21','Open':145.232,'High':146.885,'Low':144.454,'Close':145.207},
    {'Date':'2024-08-22','Open':145.176,'High':146.529,'Low':144.846,'Close':146.276},
    {'Date':'2024-08-23','Open':146.273,'High':146.479,'Low':144.046,'Close':144.336},
    {'Date':'2024-08-26','Open':144.270,'High':144.650,'Low':143.447,'Close':144.507},
    {'Date':'2024-08-27','Open':144.513,'High':145.173,'Low':143.917,'Close':143.933},
    {'Date':'2024-08-28','Open':143.927,'High':145.036,'Low':143.684,'Close':144.569},
    {'Date':'2024-08-29','Open':144.590,'High':145.550,'Low':144.220,'Close':144.981},
    {'Date':'2024-08-30','Open':144.979,'High':146.246,'Low':144.658,'Close':146.151},

    # ===================== 2024-09 =====================
    {'Date':'2024-09-02','Open':146.060,'High':147.172,'Low':145.776,'Close':146.912},
    {'Date':'2024-09-03','Open':146.894,'High':147.206,'Low':145.106,'Close':145.455},
    {'Date':'2024-09-04','Open':145.451,'High':145.557,'Low':143.706,'Close':143.722},
    {'Date':'2024-09-05','Open':143.715,'High':144.224,'Low':142.849,'Close':143.429},
    {'Date':'2024-09-06','Open':143.426,'High':144.063,'Low':141.751,'Close':142.257},
    {'Date':'2024-09-09','Open':142.220,'High':143.794,'Low':141.949,'Close':143.163},
    {'Date':'2024-09-10','Open':143.165,'High':143.708,'Low':142.195,'Close':142.447},
    {'Date':'2024-09-11','Open':142.429,'High':142.545,'Low':140.709,'Close':142.342},
    {'Date':'2024-09-12','Open':142.292,'High':143.042,'Low':141.724,'Close':141.802},
    {'Date':'2024-09-13','Open':141.803,'High':141.877,'Low':140.282,'Close':140.793},
    {'Date':'2024-09-16','Open':140.840,'High':140.917,'Low':139.578,'Close':140.600},
    {'Date':'2024-09-17','Open':140.587,'High':142.464,'Low':140.320,'Close':142.391},
    {'Date':'2024-09-18','Open':142.390,'High':142.707,'Low':140.440,'Close':142.258},
    {'Date':'2024-09-19','Open':142.265,'High':143.942,'Low':141.881,'Close':142.609},
    {'Date':'2024-09-20','Open':142.612,'High':144.494,'Low':141.737,'Close':143.845},
    {'Date':'2024-09-23','Open':143.895,'High':144.457,'Low':143.164,'Close':143.581},
    {'Date':'2024-09-24','Open':143.488,'High':144.677,'Low':143.110,'Close':143.201},
    {'Date':'2024-09-25','Open':143.202,'High':144.842,'Low':142.889,'Close':144.731},
    {'Date':'2024-09-26','Open':144.728,'High':145.210,'Low':144.109,'Close':144.806},
    {'Date':'2024-09-27','Open':144.772,'High':146.492,'Low':142.067,'Close':142.169},
    {'Date':'2024-09-30','Open':142.116,'High':143.914,'Low':141.643,'Close':143.606},

    # ===================== 2023-10 (continued into 2024-10 due to naming) =====================
    {'Date':'2024-10-01','Open':143.593,'High':144.534,'Low':142.971,'Close':143.546},
    {'Date':'2024-10-02','Open':143.553,'High':146.510,'Low':143.421,'Close':146.439},
    {'Date':'2024-10-03','Open':146.436,'High':147.241,'Low':146.255,'Close':146.897},
    {'Date':'2024-10-04','Open':146.871,'High':149.002,'Low':145.918,'Close':148.661},
    {'Date':'2024-10-07','Open':148.639,'High':149.123,'Low':147.851,'Close':148.172},
    {'Date':'2024-10-08','Open':148.118,'High':148.379,'Low':147.344,'Close':148.171},
    {'Date':'2024-10-09','Open':148.179,'High':149.362,'Low':148.011,'Close':149.286},
    {'Date':'2024-10-10','Open':149.240,'High':149.601,'Low':148.239,'Close':148.553},
    {'Date':'2024-10-11','Open':148.539,'High':149.283,'Low':148.401,'Close':149.102},
    {'Date':'2024-10-14','Open':148.952,'High':149.981,'Low':148.952,'Close':149.734},
    {'Date':'2024-10-15','Open':149.733,'High':149.834,'Low':148.851,'Close':149.181},
    {'Date':'2024-10-16','Open':149.288,'High':149.805,'Low':148.872,'Close':149.617},
    {'Date':'2024-10-17','Open':149.560,'High':150.321,'Low':149.238,'Close':150.188},
    {'Date':'2024-10-18','Open':150.147,'High':150.283,'Low':149.364,'Close':149.488},
    {'Date':'2024-10-21','Open':149.490,'High':150.884,'Low':149.084,'Close':150.818},
    {'Date':'2024-10-22','Open':150.758,'High':151.193,'Low':150.490,'Close':151.050},
    {'Date':'2024-10-23','Open':151.054,'High':153.183,'Low':150.976,'Close':152.745},
    {'Date':'2024-10-24','Open':152.733,'High':152.824,'Low':151.549,'Close':151.808},
    {'Date':'2024-10-25','Open':151.839,'High':152.378,'Low':151.441,'Close':152.287},
    {'Date':'2024-10-28','Open':152.897,'High':153.881,'Low':152.409,'Close':153.242},
    {'Date':'2024-10-29','Open':153.236,'High':153.865,'Low':152.752,'Close':153.330},
    {'Date':'2024-10-30','Open':153.330,'High':153.494,'Low':152.778,'Close':153.306},
    {'Date':'2024-10-31','Open':153.304,'High':153.616,'Low':151.835,'Close':152.041},

    # ===================== 2023-11 (continued into 2024-11 due to naming) =====================
    {'Date':'2024-11-01','Open':152.040,'High':153.093,'Low':151.787,'Close':152.950},
    {'Date':'2024-11-04','Open':152.292,'High':152.551,'Low':151.533,'Close':152.111},
    {'Date':'2024-11-05','Open':152.096,'High':152.543,'Low':151.334,'Close':151.589},
    {'Date':'2024-11-06','Open':151.607,'High':154.697,'Low':151.287,'Close':154.595},
    {'Date':'2024-11-07','Open':154.582,'High':154.709,'Low':152.692,'Close':152.894},
    {'Date':'2024-11-08','Open':152.913,'High':153.367,'Low':152.141,'Close':152.618},
    {'Date':'2024-11-11','Open':152.609,'High':153.951,'Low':152.606,'Close':153.704},
    {'Date':'2024-11-12','Open':153.692,'High':154.923,'Low':153.403,'Close':154.585},
    {'Date':'2024-11-13','Open':154.574,'High':155.621,'Low':154.342,'Close':155.449},
    {'Date':'2024-11-14','Open':155.385,'High':156.415,'Low':155.278,'Close':156.237},
    {'Date':'2024-11-15','Open':156.256,'High':156.746,'Low':153.860,'Close':154.308},
    {'Date':'2024-11-18','Open':154.200,'High':155.354,'Low':153.838,'Close':154.638},
    {'Date':'2024-11-19','Open':154.624,'High':154.797,'Low':153.282,'Close':154.627},
    {'Date':'2024-11-20','Open':154.624,'High':155.885,'Low':154.523,'Close':155.370},
    {'Date':'2024-11-21','Open':155.363,'High':155.414,'Low':153.908,'Close':154.520},
    {'Date':'2024-11-22','Open':154.476,'High':155.016,'Low':153.965,'Close':154.704},
    {'Date':'2024-11-25','Open':154.133,'High':154.721,'Low':153.547,'Close':154.164},
    {'Date':'2024-11-26','Open':154.201,'High':154.486,'Low':152.986,'Close':153.088},
    {'Date':'2024-11-27','Open':153.074,'High':153.232,'Low':150.453,'Close':151.052},
    {'Date':'2024-11-28','Open':150.985,'High':151.947,'Low':150.901,'Close':151.513},
    {'Date':'2024-11-29','Open':151.517,'High':151.542,'Low':149.465,'Close':149.660},

    # ===================== 2023-12 (continued into 2024-12) =====================
    {'Date':'2024-12-02','Open':149.650,'High':150.746,'Low':149.079,'Close':149.564},
    {'Date':'2024-12-03','Open':149.567,'High':150.234,'Low':148.640,'Close':149.530},
    {'Date':'2024-12-04','Open':149.594,'High':151.226,'Low':149.503,'Close':150.518},
    {'Date':'2024-12-05','Open':150.520,'High':150.775,'Low':149.654,'Close':150.039},
    {'Date':'2024-12-06','Open':150.013,'High':150.698,'Low':149.365,'Close':150.025},
    {'Date':'2024-12-09','Open':149.887,'High':151.345,'Low':149.691,'Close':151.165},
    {'Date':'2024-12-10','Open':151.165,'High':152.179,'Low':150.895,'Close':151.869},
    {'Date':'2024-12-11','Open':151.881,'High':152.838,'Low':151.002,'Close':152.370},
    {'Date':'2024-12-12','Open':152.366,'High':152.772,'Low':151.801,'Close':152.559},
    {'Date':'2024-12-13','Open':152.527,'High':153.799,'Low':152.454,'Close':153.606},
    {'Date':'2024-12-16','Open':153.561,'High':154.476,'Low':153.325,'Close':154.076},
    {'Date':'2024-12-17','Open':154.082,'High':154.342,'Low':153.160,'Close':153.380},
    {'Date':'2024-12-18','Open':153.384,'High':154.856,'Low':153.253,'Close':154.728},
    {'Date':'2024-12-19','Open':154.672,'High':157.805,'Low':154.433,'Close':157.349},
    {'Date':'2024-12-20','Open':157.371,'High':157.923,'Low':155.951,'Close':156.423},
    {'Date':'2024-12-23','Open':156.312,'High':157.266,'Low':156.288,'Close':157.070},
    {'Date':'2024-12-24','Open':157.080,'High':157.391,'Low':156.889,'Close':157.074},
    {'Date':'2024-12-25','Open':157.192,'High':157.192,'Low':157.068,'Close':157.069},
    {'Date':'2024-12-26','Open':157.205,'High':158.082,'Low':157.067,'Close':157.934},
    {'Date':'2024-12-27','Open':157.882,'High':158.002,'Low':157.349,'Close':157.785},
    {'Date':'2024-12-30','Open':157.725,'High':158.073,'Low':156.673,'Close':156.776},
    {'Date':'2024-12-31','Open':156.787,'High':157.547,'Low':156.020,'Close':157.121},

    # ===================== 2025-01 =====================
    {'Date':'2025-01-01','Open':157.059,'High':157.061,'Low':157.059,'Close':157.061},
    {'Date':'2025-01-02','Open':157.125,'High':157.848,'Low':156.440,'Close':157.444},
    #{'Date':'2025-01-03','Open':157.397,'High':157.564,'Low':156.873,'Close':157.261},
    #{'Date':'2025-01-06','Open':157.130,'High':157.960,'Low':156.241,'Close':157.514},
    #{'Date':'2025-01-07','Open':157.510,'High':158.423,'Low':157.398,'Close':157.988},
]



############################################################################
# 2) PREP THE DATA
############################################################################

def load_full_2024_data():
    """
    Create a DataFrame from the entire train_data array (2023-01-02 -> 2025-01-02).
    We'll keep the function name 'load_full_2024_data' for consistency,
    even though it now holds data spanning 2023 -> 2025.
    """
    df = pd.DataFrame(train_data)
    df['Date'] = pd.to_datetime(df['Date'])
    df.set_index('Date', inplace=True)
    df.sort_index(inplace=True)
    return df

def clean_data(df):
    """
    Simple cleaning: sort, remove duplicates, drop NaN if any exist.
    """
    df.sort_index(inplace=True)
    df = df[~df.index.duplicated(keep='first')]
    df.dropna(inplace=True)
    return df

############################################################################
# 3) BUILD DATASET (multi-window, single-step)
############################################################################

def build_dataset(df, w_max=5):
    """
    We'll do single-step next-day forecasting:
      X = flattened last w days of O,H,L,C
      Y = next day's [Low, High, Close]
    We'll gather multiple windows: w=1..w_max
    Return X, Y, plus meta_info for reference.
    """
    df_np = df[['Open','High','Low','Close']].values
    dates = df.index.to_list()
    n = len(df_np)

    # We'll store all training samples in these lists.
    X_list, Y_list, info_list = [], [], []

    max_len = w_max * 4  # For w rows, each has 4 columns => O,H,L,C

    for w in range(1, w_max+1):
        for t in range(w, n):
            if t >= n:
                break
            # Flatten last w days
            window_data = df_np[t-w : t, :]  # shape (w,4)
            window_flat = window_data.flatten()

            # Pad if needed
            padded = np.zeros(max_len, dtype=float)
            start_idx = max_len - len(window_flat)
            padded[start_idx:] = window_flat

            # Next-day's O,H,L,C is day t
            future_day = df_np[t]   # shape(4,)
            day_low   = future_day[2]
            day_high  = future_day[1]
            day_close = future_day[3]
            target = np.array([day_low, day_high, day_close], dtype=float)

            # Optionally embed w as a feature
            feature = np.concatenate([padded, [float(w)]], axis=0)

            X_list.append(feature)
            Y_list.append(target)
            info_list.append((w, dates[t]))

    X = np.array(X_list, dtype=float)
    Y = np.array(Y_list, dtype=float)
    return X, Y, info_list

############################################################################
# 4) TRAIN MODEL
############################################################################

def train_model(X, Y):
    """
    Train a multi-output regressor (LinearRegression).
    """
    base = LinearRegression()
    model = MultiOutputRegressor(base)
    model.fit(X, Y)
    return model

############################################################################
# 5) PREDICT JUST THE NEXT DAY: 2025-01-03
############################################################################

def predict_next_trading_day(df, model, w_max=5):
    """
    We'll define the 'latest day' in df as 2025-01-02 (the last row).
    We gather the last w_max rows, flatten, and predict day 2025-01-03.
    """
    recent_df = df[['Open','High','Low','Close']].tail(w_max)
    arr = recent_df.values.flatten()

    max_len = w_max * 4
    padded = np.zeros(max_len, dtype=float)
    start_idx = max_len - len(arr)
    padded[start_idx:] = arr

    final_feature = np.concatenate([padded, [float(w_max)]], axis=0).reshape(1, -1)
    pred = model.predict(final_feature)[0]  # shape (3,)
    pred_low, pred_high, pred_close = pred
    return pred_low, pred_high, pred_close

############################################################################
# 6) MAIN
############################################################################

def main():
    df_2024 = load_full_2024_data()
    df_2024 = clean_data(df_2024)

    # We'll exclude the final row (2025-01-02) from training
    final_index = df_2024.index[-1]   # 2025-01-02
    df_train = df_2024.iloc[:-1].copy()
    print(f"Training on {len(df_train)} rows. Final row excluded: {final_index}")

    # Build dataset
    X, Y, info = build_dataset(df_train, w_max=5)
    print(f"Dataset shapes: X={X.shape}, Y={Y.shape}")
    print(f"Sample info last 5:\n{info[-5:]}")

    # Train
    model = train_model(X, Y)
    print("Model training complete.")

    # Predict next day => 2025-01-03
    pred_low, pred_high, pred_close = predict_next_trading_day(df_2024, model, w_max=5)
    print("\n=== PREDICTION FOR 2025-01-07 ===")
    print(f"Predicted Low:   {pred_low:.5f}")
    print(f"Predicted High:  {pred_high:.5f}")
    print(f"Predicted Close: {pred_close:.5f}")

if __name__ == "__main__":
    main()
