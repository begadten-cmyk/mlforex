import pandas as pd
import numpy as np
from sklearn.multioutput import MultiOutputRegressor
from sklearn.linear_model import LinearRegression
import datetime

############################################################################
# 1) FULL DATA (2023-01-02 -> 2025-01-02)
#    EXACTLY as you provided, stored in 'train_data'.
#    Each row is { 'Date','Open','Close','High','Low','Mid' }.
#    We only use O,H,L,C in the code; 'Mid' is dropped.
############################################################################

train_data = [

    # ===================== 2023-01 =====================
    {'Date':'2023-01-02','Open':158.124,'High':158.198,'Low':157.324,'Close':157.410,'Mid':0.80243},
    {'Date':'2023-01-03','Open':157.410,'High':158.375,'Low':155.347,'Close':156.755,'Mid':0.80243},
    {'Date':'2023-01-04','Open':156.745,'High':160.171,'Low':156.496,'Close':159.853,'Mid':0.80243},
    {'Date':'2023-01-05','Open':159.917,'High':160.038,'Low':158.504,'Close':158.913,'Mid':0.80243},
    {'Date':'2023-01-06','Open':158.750,'High':160.015,'Low':158.567,'Close':159.815,'Mid':0.80243},
    {'Date':'2023-01-09','Open':159.280,'High':161.234,'Low':159.206,'Close':160.675,'Mid':0.80243},
    {'Date':'2023-01-10','Open':160.484,'High':160.931,'Low':160.029,'Close':160.667,'Mid':0.80243},
    {'Date':'2023-01-11','Open':160.573,'High':161.203,'Low':160.400,'Close':160.964,'Mid':0.80243},
    {'Date':'2023-01-12','Open':160.745,'High':160.908,'Low':157.708,'Close':157.818,'Mid':0.80243},
    {'Date':'2023-01-13','Open':157.790,'High':158.048,'Low':155.637,'Close':156.432,'Mid':0.80243},
    {'Date':'2023-01-16','Open':155.987,'High':157.069,'Low':155.790,'Close':156.778,'Mid':0.80243},
    {'Date':'2023-01-17','Open':156.635,'High':158.027,'Low':156.378,'Close':157.412,'Mid':0.80243},
    {'Date':'2023-01-18','Open':157.394,'High':161.521,'Low':157.149,'Close':159.150,'Mid':0.80243},
    {'Date':'2023-01-19','Open':159.110,'High':159.217,'Low':157.564,'Close':159.100,'Mid':0.80243},
    {'Date':'2023-01-20','Open':159.020,'High':161.282,'Low':158.981,'Close':160.683,'Mid':0.80243},
    {'Date':'2023-01-23','Open':160.494,'High':161.798,'Low':160.357,'Close':161.767,'Mid':0.80243},
    {'Date':'2023-01-24','Open':161.689,'High':161.773,'Low':159.984,'Close':160.557,'Mid':0.80243},
    {'Date':'2023-01-25','Open':160.427,'High':160.919,'Low':159.493,'Close':160.693,'Mid':0.80243},
    {'Date':'2023-01-26','Open':160.628,'High':161.729,'Low':159.997,'Close':161.580,'Mid':0.80243},
    {'Date':'2023-01-27','Open':161.515,'High':161.606,'Low':160.402,'Close':160.965,'Mid':0.80243},
    {'Date':'2023-01-30','Open':160.612,'High':161.415,'Low':160.197,'Close':161.086,'Mid':0.80243},
    {'Date':'2023-01-31','Open':161.002,'High':161.190,'Low':159.760,'Close':160.272,'Mid':0.80243},

    # ===================== 2023-02 =====================
    {'Date':'2023-02-01','Open':160.169,'High':160.667,'Low':158.907,'Close':159.544,'Mid':0.80243},
    {'Date':'2023-02-02','Open':159.490,'High':159.609,'Low':157.178,'Close':157.317,'Mid':0.80243},
    {'Date':'2023-02-03','Open':157.190,'High':158.744,'Low':156.723,'Close':158.080,'Mid':0.80243},
    {'Date':'2023-02-06','Open':159.214,'High':159.949,'Low':158.473,'Close':159.409,'Mid':0.80243},
    {'Date':'2023-02-07','Open':159.364,'High':159.570,'Low':157.425,'Close':157.871,'Mid':0.80243},
    {'Date':'2023-02-08','Open':157.829,'High':158.833,'Low':157.602,'Close':158.604,'Mid':0.80243},
    {'Date':'2023-02-09','Open':158.438,'High':159.504,'Low':158.125,'Close':159.441,'Mid':0.80243},
    {'Date':'2023-02-10','Open':159.368,'High':159.625,'Low':157.525,'Close':158.405,'Mid':0.80243},
    {'Date':'2023-02-13','Open':158.300,'High':161.194,'Low':158.290,'Close':160.717,'Mid':0.80243},
    {'Date':'2023-02-14','Open':160.651,'High':162.175,'Low':160.100,'Close':162.038,'Mid':0.80243},
    {'Date':'2023-02-15','Open':161.975,'High':162.054,'Low':160.747,'Close':161.421,'Mid':0.80243},
    {'Date':'2023-02-16','Open':161.253,'High':161.508,'Low':160.462,'Close':160.574,'Mid':0.80243},
    {'Date':'2023-02-17','Open':160.599,'High':161.639,'Low':160.488,'Close':161.512,'Mid':0.80243},
    {'Date':'2023-02-20','Open':161.356,'High':161.724,'Low':161.163,'Close':161.578,'Mid':0.80243},
    {'Date':'2023-02-21','Open':161.555,'High':163.752,'Low':161.426,'Close':163.525,'Mid':0.80243},
    {'Date':'2023-02-22','Open':163.470,'High':163.557,'Low':162.387,'Close':162.516,'Mid':0.80243},
    {'Date':'2023-02-23','Open':162.467,'High':162.849,'Low':161.667,'Close':161.799,'Mid':0.80243},
    {'Date':'2023-02-24','Open':161.769,'High':163.117,'Low':161.193,'Close':162.947,'Mid':0.80243},
    {'Date':'2023-02-27','Open':163.002,'High':164.332,'Low':162.600,'Close':164.319,'Mid':0.80243},
    {'Date':'2023-02-28','Open':164.306,'High':166.009,'Low':163.711,'Close':163.752,'Mid':0.80243},

    # ===================== 2023-03 =====================
    {'Date':'2023-03-01','Open':163.761,'High':164.506,'Low':162.861,'Close':163.811,'Mid':0.80243},
    {'Date':'2023-03-02','Open':163.774,'High':163.930,'Low':163.062,'Close':163.386,'Mid':0.80243},
    {'Date':'2023-03-03','Open':163.374,'High':163.640,'Low':163.078,'Close':163.585,'Mid':0.80243},
    {'Date':'2023-03-06','Open':163.428,'High':163.787,'Low':162.976,'Close':163.474,'Mid':0.80243},
    {'Date':'2023-03-07','Open':163.433,'High':163.855,'Low':162.041,'Close':162.204,'Mid':0.80243},
    {'Date':'2023-03-08','Open':162.172,'High':162.978,'Low':161.700,'Close':162.690,'Mid':0.80243},
    {'Date':'2023-03-09','Open':162.657,'High':162.657,'Low':161.606,'Close':162.273,'Mid':0.80243},
    {'Date':'2023-03-10','Open':162.324,'High':164.307,'Low':161.943,'Close':162.487,'Mid':0.80243},
    {'Date':'2023-03-13','Open':161.807,'High':163.069,'Low':160.035,'Close':162.275,'Mid':0.80243},
    {'Date':'2023-03-14','Open':162.273,'High':164.079,'Low':161.856,'Close':163.130,'Mid':0.80243},
    {'Date':'2023-03-15','Open':163.130,'High':164.137,'Low':159.205,'Close':160.591,'Mid':0.80243},
    {'Date':'2023-03-16','Open':160.591,'High':162.104,'Low':158.555,'Close':161.739,'Mid':0.80243},
    {'Date':'2023-03-17','Open':161.738,'High':162.179,'Low':160.109,'Close':160.511,'Mid':0.80243},
    {'Date':'2023-03-20','Open':160.847,'High':161.723,'Low':158.953,'Close':161.131,'Mid':0.80243},
    {'Date':'2023-03-21','Open':161.131,'High':162.256,'Low':160.755,'Close':161.771,'Mid':0.80243},
    {'Date':'2023-03-22','Open':161.765,'High':163.337,'Low':160.783,'Close':161.123,'Mid':0.80243},
    {'Date':'2023-03-23','Open':161.123,'High':161.852,'Low':159.928,'Close':160.726,'Mid':0.80243},
    {'Date':'2023-03-24','Open':160.726,'High':160.833,'Low':158.257,'Close':159.879,'Mid':0.80243},
    {'Date':'2023-03-27','Open':159.479,'High':161.841,'Low':159.436,'Close':161.664,'Mid':0.80243},
    {'Date':'2023-03-28','Open':161.643,'High':161.771,'Low':160.731,'Close':161.538,'Mid':0.80243},
    {'Date':'2023-03-29','Open':161.497,'High':163.678,'Low':161.336,'Close':163.610,'Mid':0.80243},
    {'Date':'2023-03-30','Open':163.611,'High':164.447,'Low':162.970,'Close':164.377,'Mid':0.80243},
    {'Date':'2023-03-31','Open':164.336,'High':165.467,'Low':163.618,'Close':163.762,'Mid':0.80243},

    # ===================== 2023-04 =====================
    {'Date':'2023-04-03','Open':164.326,'High':164.897,'Low':163.422,'Close':164.410,'Mid':0.80243},
    {'Date':'2023-04-04','Open':164.401,'High':166.399,'Low':164.173,'Close':164.653,'Mid':0.80243},
    {'Date':'2023-04-05','Open':164.630,'High':164.667,'Low':162.764,'Close':163.553,'Mid':0.80243},
    {'Date':'2023-04-06','Open':163.514,'High':164.110,'Low':162.889,'Close':163.868,'Mid':0.80243},
    {'Date':'2023-04-07','Open':163.818,'High':164.398,'Low':163.513,'Close':164.097,'Mid':0.80243},
    {'Date':'2023-04-10','Open':163.984,'High':165.492,'Low':163.787,'Close':165.434,'Mid':0.80243},
    {'Date':'2023-04-11','Open':165.395,'High':166.190,'Low':165.185,'Close':166.131,'Mid':0.80243},
    {'Date':'2023-04-12','Open':166.085,'High':166.592,'Low':165.373,'Close':166.216,'Mid':0.80243},
    {'Date':'2023-04-13','Open':166.191,'High':166.843,'Low':165.399,'Close':166.026,'Mid':0.80243},
    {'Date':'2023-04-14','Open':165.986,'High':166.229,'Low':165.401,'Close':166.028,'Mid':0.80243},
    {'Date':'2023-04-17','Open':165.933,'High':166.630,'Low':165.690,'Close':166.445,'Mid':0.80243},
    {'Date':'2023-04-18','Open':166.399,'High':167.007,'Low':166.119,'Close':166.614,'Mid':0.80243},
    {'Date':'2023-04-19','Open':166.597,'High':167.968,'Low':166.485,'Close':167.519,'Mid':0.80243},
    {'Date':'2023-04-20','Open':167.539,'High':167.703,'Low':166.839,'Close':167.034,'Mid':0.80243},
    {'Date':'2023-04-21','Open':167.021,'High':167.078,'Low':165.511,'Close':166.896,'Mid':0.80243},
    {'Date':'2023-04-24','Open':166.672,'High':167.716,'Low':166.536,'Close':167.611,'Mid':0.80243},
    {'Date':'2023-04-25','Open':167.608,'High':167.954,'Low':165.420,'Close':165.950,'Mid':0.80243},
    {'Date':'2023-04-26','Open':165.915,'High':167.011,'Low':165.644,'Close':166.690,'Mid':0.80243},
    {'Date':'2023-04-27','Open':166.593,'High':167.503,'Low':166.312,'Close':167.444,'Mid':0.80243},
    {'Date':'2023-04-28','Open':167.390,'High':171.162,'Low':166.440,'Close':171.106,'Mid':0.80243},

    # ===================== 2023-05 =====================
    {'Date':'2023-05-01','Open':170.876,'High':172.083,'Low':170.867,'Close':171.726,'Mid':0.80243},
    {'Date':'2023-05-02','Open':171.733,'High':172.324,'Low':169.949,'Close':170.303,'Mid':0.80243},
    {'Date':'2023-05-03','Open':170.249,'High':170.374,'Low':169.141,'Close':169.413,'Mid':0.80243},
    {'Date':'2023-05-04','Open':169.301,'High':169.539,'Low':168.054,'Close':168.795,'Mid':0.80243},
    {'Date':'2023-05-05','Open':168.787,'High':170.612,'Low':168.484,'Close':170.276,'Mid':0.80243},
    {'Date':'2023-05-08','Open':170.272,'High':171.066,'Low':170.177,'Close':170.492,'Mid':0.80243},
    {'Date':'2023-05-09','Open':170.467,'High':170.711,'Low':169.853,'Close':170.677,'Mid':0.80243},
    {'Date':'2023-05-10','Open':170.639,'High':171.174,'Low':169.101,'Close':169.654,'Mid':0.80243},
    {'Date':'2023-05-11','Open':169.606,'High':169.740,'Low':167.839,'Close':168.376,'Mid':0.80243},
    {'Date':'2023-05-12','Open':168.326,'High':169.131,'Low':168.076,'Close':168.939,'Mid':0.80243},
    {'Date':'2023-05-15','Open':168.815,'High':170.621,'Low':168.773,'Close':170.498,'Mid':0.80243},
    {'Date':'2023-05-16','Open':170.480,'High':170.839,'Low':169.397,'Close':170.266,'Mid':0.80243},
    {'Date':'2023-05-17','Open':170.229,'High':172.004,'Low':170.067,'Close':171.817,'Mid':0.80243},
    {'Date':'2023-05-18','Open':171.903,'High':172.158,'Low':171.188,'Close':172.105,'Mid':0.80243},
    {'Date':'2023-05-19','Open':172.091,'High':172.509,'Low':171.243,'Close':171.705,'Mid':0.80243},
    {'Date':'2023-05-22','Open':171.622,'High':172.578,'Low':171.194,'Close':172.370,'Mid':0.80243},
    {'Date':'2023-05-23','Open':172.337,'High':172.622,'Low':171.280,'Close':172.061,'Mid':0.80243},
    {'Date':'2023-05-24','Open':171.999,'High':172.791,'Low':171.224,'Close':172.448,'Mid':0.80243},
    {'Date':'2023-05-25','Open':172.414,'High':172.772,'Low':171.682,'Close':172.544,'Mid':0.80243},
    {'Date':'2023-05-26','Open':172.511,'High':173.731,'Low':172.201,'Close':173.603,'Mid':0.80243},
    {'Date':'2023-05-29','Open':173.377,'High':173.952,'Low':172.946,'Close':173.522,'Mid':0.80243},
    {'Date':'2023-05-30','Open':173.463,'High':174.274,'Low':172.988,'Close':173.486,'Mid':0.80243},
    {'Date':'2023-05-31','Open':173.480,'High':173.643,'Low':172.525,'Close':173.338,'Mid':0.80243},

    # ===================== 2023-06 =====================
    {'Date':'2023-06-01','Open':173.315,'High':174.191,'Low':172.957,'Close':173.867,'Mid':0.80243},
    {'Date':'2023-06-02','Open':173.818,'High':174.676,'Low':173.663,'Close':174.254,'Mid':0.80243},
    {'Date':'2023-06-05','Open':174.149,'High':174.361,'Low':172.849,'Close':173.538,'Mid':0.80243},
    {'Date':'2023-06-06','Open':173.522,'High':173.773,'Low':172.672,'Close':173.493,'Mid':0.80243},
    {'Date':'2023-06-07','Open':173.444,'High':174.435,'Low':172.663,'Close':174.356,'Mid':0.80243},
    {'Date':'2023-06-08','Open':174.291,'High':174.513,'Low':173.900,'Close':174.456,'Mid':0.80243},
    {'Date':'2023-06-09','Open':174.462,'High':175.542,'Low':174.161,'Close':175.324,'Mid':0.80243},
    {'Date':'2023-06-12','Open':175.060,'High':175.767,'Low':174.350,'Close':174.684,'Mid':0.80243},
    {'Date':'2023-06-13','Open':174.640,'High':176.846,'Low':174.452,'Close':176.840,'Mid':0.80243},
    {'Date':'2023-06-14','Open':176.804,'High':177.406,'Low':176.442,'Close':177.393,'Mid':0.80243},
    {'Date':'2023-06-15','Open':177.328,'High':179.394,'Low':177.124,'Close':179.327,'Mid':0.80243},
    {'Date':'2023-06-16','Open':179.295,'High':182.044,'Low':178.821,'Close':181.894,'Mid':0.80243},
    {'Date':'2023-06-19','Open':181.583,'High':182.118,'Low':181.215,'Close':181.558,'Mid':0.80243},
    {'Date':'2023-06-20','Open':181.611,'High':182.088,'Low':179.921,'Close':180.493,'Mid':0.80243},
    {'Date':'2023-06-21','Open':180.492,'High':181.602,'Low':179.922,'Close':181.143,'Mid':0.80243},
    {'Date':'2023-06-22','Open':181.012,'High':182.557,'Low':180.707,'Close':182.424,'Mid':0.80243},
    {'Date':'2023-06-23','Open':182.420,'High':182.940,'Low':181.248,'Close':182.680,'Mid':0.80243},
    {'Date':'2023-06-26','Open':182.308,'High':182.985,'Low':181.681,'Close':182.411,'Mid':0.80243},
    {'Date':'2023-06-27','Open':182.394,'High':183.761,'Low':182.226,'Close':183.666,'Mid':0.80243},
    {'Date':'2023-06-28','Open':183.666,'High':183.683,'Low':182.142,'Close':182.552,'Mid':0.80243},
    {'Date':'2023-06-29','Open':182.539,'High':182.878,'Low':182.213,'Close':182.540,'Mid':0.80243},
    {'Date':'2023-06-30','Open':182.555,'High':183.873,'Low':182.198,'Close':183.190,'Mid':0.80243},

    # ===================== 2023-07 =====================
    {'Date':'2023-07-03','Open':183.065,'High':183.754,'Low':183.043,'Close':183.599,'Mid':0.80243},
    {'Date':'2023-07-04','Open':183.615,'High':183.906,'Low':183.229,'Close':183.669,'Mid':0.80243},
    {'Date':'2023-07-05','Open':183.505,'High':184.011,'Low':183.148,'Close':183.766,'Mid':0.80243},
    {'Date':'2023-07-06','Open':183.735,'High':184.004,'Low':182.497,'Close':183.530,'Mid':0.80243},
    {'Date':'2023-07-07','Open':183.521,'High':183.561,'Low':182.018,'Close':182.411,'Mid':0.80243},
    {'Date':'2023-07-10','Open':182.312,'High':183.220,'Low':181.095,'Close':181.732,'Mid':0.80243},
    {'Date':'2023-07-11','Open':181.784,'High':181.985,'Low':180.789,'Close':181.517,'Mid':0.80243},
    {'Date':'2023-07-12','Open':181.514,'High':181.514,'Low':179.466,'Close':179.858,'Mid':0.80243},
    {'Date':'2023-07-13','Open':179.724,'High':181.459,'Low':179.485,'Close':181.324,'Mid':0.80243},
    {'Date':'2023-07-14','Open':181.317,'High':182.283,'Low':180.188,'Close':181.815,'Mid':0.80243},
    {'Date':'2023-07-17','Open':181.750,'High':182.145,'Low':180.570,'Close':181.331,'Mid':0.80243},
    {'Date':'2023-07-18','Open':181.429,'High':181.839,'Low':180.359,'Close':180.972,'Mid':0.80243},
    {'Date':'2023-07-19','Open':180.931,'High':181.626,'Low':179.818,'Close':180.681,'Mid':0.80243},
    {'Date':'2023-07-20','Open':180.566,'High':180.715,'Low':179.692,'Close':180.226,'Mid':0.80243},
    {'Date':'2023-07-21','Open':180.171,'High':182.527,'Low':179.905,'Close':182.263,'Mid':0.80243},
    {'Date':'2023-07-24','Open':181.901,'High':182.341,'Low':180.746,'Close':181.447,'Mid':0.80243},
    {'Date':'2023-07-25','Open':181.450,'High':182.009,'Low':181.141,'Close':181.795,'Mid':0.80243},
    {'Date':'2023-07-26','Open':181.734,'High':181.949,'Low':180.907,'Close':181.480,'Mid':0.80243},
    {'Date':'2023-07-27','Open':181.286,'High':181.925,'Low':177.407,'Close':178.429,'Mid':0.80243},
    {'Date':'2023-07-28','Open':178.470,'High':181.489,'Low':176.305,'Close':181.370,'Mid':0.80243},
    {'Date':'2023-07-31','Open':180.929,'High':183.186,'Low':180.866,'Close':182.607,'Mid':0.80243},

    # ===================== 2023-08 =====================
    {'Date':'2023-08-01','Open':182.642,'High':183.250,'Low':182.439,'Close':183.090,'Mid':0.80243},
    {'Date':'2023-08-02','Open':183.065,'High':183.126,'Low':181.749,'Close':182.177,'Mid':0.80243},
    {'Date':'2023-08-03','Open':182.168,'High':182.760,'Low':180.424,'Close':181.164,'Mid':0.80243},
    {'Date':'2023-08-04','Open':181.238,'High':181.739,'Low':180.547,'Close':180.693,'Mid':0.80243},
    {'Date':'2023-08-07','Open':180.437,'High':182.189,'Low':180.433,'Close':182.139,'Mid':0.80243},
    {'Date':'2023-08-08','Open':182.137,'High':182.955,'Low':181.371,'Close':182.756,'Mid':0.80243},
    {'Date':'2023-08-09','Open':182.755,'High':183.019,'Low':182.300,'Close':182.796,'Mid':0.80243},
    {'Date':'2023-08-10','Open':182.723,'High':184.242,'Low':182.611,'Close':183.454,'Mid':0.80243},
    {'Date':'2023-08-11','Open':183.450,'High':184.230,'Low':183.229,'Close':184.018,'Mid':0.80243},
    {'Date':'2023-08-14','Open':183.786,'High':184.728,'Low':183.461,'Close':184.601,'Mid':0.80243},
    {'Date':'2023-08-15','Open':184.478,'High':185.322,'Low':184.286,'Close':184.917,'Mid':0.80243},
    {'Date':'2023-08-16','Open':184.965,'High':186.334,'Low':184.689,'Close':186.309,'Mid':0.80243},
    {'Date':'2023-08-17','Open':186.110,'High':186.468,'Low':185.553,'Close':185.875,'Mid':0.80243},
    {'Date':'2023-08-18','Open':185.881,'High':185.903,'Low':184.547,'Close':185.114,'Mid':0.80243},
    {'Date':'2023-08-21','Open':184.884,'High':186.656,'Low':184.880,'Close':186.504,'Mid':0.80243},
    {'Date':'2023-08-22','Open':186.388,'High':186.765,'Low':185.526,'Close':185.740,'Mid':0.80243},
    {'Date':'2023-08-23','Open':185.721,'High':185.940,'Low':183.367,'Close':184.325,'Mid':0.80243},
    {'Date':'2023-08-24','Open':184.096,'High':184.768,'Low':183.594,'Close':183.719,'Mid':0.80243},
    {'Date':'2023-08-25','Open':183.717,'High':184.405,'Low':183.352,'Close':184.145,'Mid':0.80243},
    {'Date':'2023-08-28','Open':184.052,'High':184.702,'Low':184.044,'Close':184.650,'Mid':0.80243},
    {'Date':'2023-08-29','Open':184.658,'High':185.262,'Low':184.066,'Close':184.431,'Mid':0.80243},
    {'Date':'2023-08-30','Open':184.431,'High':186.056,'Low':183.997,'Close':186.018,'Mid':0.80243},
    {'Date':'2023-08-31','Open':185.879,'High':186.025,'Low':184.078,'Close':184.426,'Mid':0.80243},

    # ===================== 2023-09 =====================
    {'Date':'2023-09-01','Open':184.428,'High':184.558,'Low':183.532,'Close':184.001,'Mid':0.80243},
    {'Date':'2023-09-04','Open':183.892,'High':185.081,'Low':183.766,'Close':184.882,'Mid':0.80243},
    {'Date':'2023-09-05','Open':184.662,'High':185.782,'Low':184.069,'Close':185.581,'Mid':0.80243},
    {'Date':'2023-09-06','Open':185.587,'High':185.616,'Low':184.242,'Close':184.681,'Mid':0.80243},
    {'Date':'2023-09-07','Open':184.719,'High':184.767,'Low':183.370,'Close':183.694,'Mid':0.80243},
    {'Date':'2023-09-08','Open':183.675,'High':184.462,'Low':183.057,'Close':184.222,'Mid':0.80243},
    {'Date':'2023-09-11','Open':183.315,'High':183.906,'Low':182.675,'Close':183.346,'Mid':0.80243},
    {'Date':'2023-09-12','Open':183.350,'High':183.928,'Low':182.941,'Close':183.634,'Mid':0.80243},
    {'Date':'2023-09-13','Open':183.719,'High':184.384,'Low':183.186,'Close':184.170,'Mid':0.80243},
    {'Date':'2023-09-14','Open':184.062,'High':184.157,'Low':182.510,'Close':182.981,'Mid':0.80243},
    {'Date':'2023-09-15','Open':182.980,'High':183.907,'Low':182.767,'Close':183.035,'Mid':0.80243},
    {'Date':'2023-09-18','Open':182.856,'High':183.342,'Low':182.718,'Close':182.759,'Mid':0.80243},
    {'Date':'2023-09-19','Open':182.779,'High':183.493,'Low':182.708,'Close':183.214,'Mid':0.80243},
    {'Date':'2023-09-20','Open':183.123,'High':183.345,'Low':182.453,'Close':183.098,'Mid':0.80243},
    {'Date':'2023-09-21','Open':182.942,'High':183.074,'Low':180.794,'Close':181.413,'Mid':0.80243},
    {'Date':'2023-09-22','Open':181.423,'High':182.304,'Low':181.203,'Close':181.564,'Mid':0.80243},
    {'Date':'2023-09-25','Open':181.538,'High':181.953,'Low':181.403,'Close':181.789,'Mid':0.80243},
    {'Date':'2023-09-26','Open':181.796,'High':181.807,'Low':181.044,'Close':181.222,'Mid':0.80243},
    {'Date':'2023-09-27','Open':181.150,'High':181.674,'Low':180.882,'Close':181.484,'Mid':0.80243},
    {'Date':'2023-09-28','Open':181.295,'High':182.418,'Low':181.056,'Close':182.200,'Mid':0.80243},
    {'Date':'2023-09-29','Open':181.946,'High':183.020,'Low':181.880,'Close':182.222,'Mid':0.80243},

    # ===================== 2023-10 =====================
    {'Date':'2023-10-02','Open':182.148,'High':182.814,'Low':181.112,'Close':181.125,'Mid':0.80243},
    {'Date':'2023-10-03','Open':181.134,'High':181.373,'Low':178.032,'Close':179.936,'Mid':0.80243},
    {'Date':'2023-10-04','Open':179.826,'High':181.256,'Low':179.559,'Close':180.943,'Mid':0.80243},
    {'Date':'2023-10-05','Open':180.900,'High':181.067,'Low':180.279,'Close':181.067,'Mid':0.80243},
    {'Date':'2023-10-06','Open':180.898,'High':182.974,'Low':180.584,'Close':182.650,'Mid':0.80243},
    {'Date':'2023-10-09','Open':181.715,'High':182.314,'Low':181.251,'Close':181.724,'Mid':0.80243},
    {'Date':'2023-10-10','Open':181.735,'High':182.781,'Low':181.531,'Close':182.700,'Mid':0.80243},
    {'Date':'2023-10-11','Open':182.677,'High':183.745,'Low':182.328,'Close':183.664,'Mid':0.80243},
    {'Date':'2023-10-12','Open':183.645,'High':183.814,'Low':182.330,'Close':182.379,'Mid':0.80243},
    {'Date':'2023-10-13','Open':182.341,'High':182.943,'Low':181.268,'Close':181.566,'Mid':0.80243},
    {'Date':'2023-10-16','Open':181.045,'High':182.728,'Low':181.045,'Close':182.660,'Mid':0.80243},
    {'Date':'2023-10-17','Open':182.486,'High':182.794,'Low':181.019,'Close':182.506,'Mid':0.80243},
    {'Date':'2023-10-18','Open':182.474,'High':182.803,'Low':181.837,'Close':182.009,'Mid':0.80243},
    {'Date':'2023-10-19','Open':181.902,'High':182.515,'Low':181.163,'Close':181.880,'Mid':0.80243},
    {'Date':'2023-10-20','Open':181.881,'High':182.362,'Low':181.279,'Close':182.268,'Mid':0.80243},
    {'Date':'2023-10-23','Open':182.050,'High':183.419,'Low':181.974,'Close':183.367,'Mid':0.80243},
    {'Date':'2023-10-24','Open':183.272,'High':183.741,'Low':182.042,'Close':182.288,'Mid':0.80243},
    {'Date':'2023-10-25','Open':182.211,'High':182.444,'Low':181.618,'Close':181.935,'Mid':0.80243},
    {'Date':'2023-10-26','Open':181.890,'High':182.574,'Low':181.107,'Close':182.365,'Mid':0.80243},
    {'Date':'2023-10-27','Open':182.352,'High':182.507,'Low':181.033,'Close':181.350,'Mid':0.80243},
    {'Date':'2023-10-30','Open':181.272,'High':181.867,'Low':180.756,'Close':181.311,'Mid':0.80243},
    {'Date':'2023-10-31','Open':181.313,'High':184.352,'Low':181.267,'Close':184.182,'Mid':0.80243},

    # ===================== 2023-11 =====================
    {'Date':'2023-11-01','Open':184.183,'High':184.258,'Low':182.932,'Close':183.335,'Mid':0.80243},
    {'Date':'2023-11-02','Open':183.317,'High':183.717,'Low':182.725,'Close':183.511,'Mid':0.80243},
    {'Date':'2023-11-03','Open':183.556,'High':185.009,'Low':183.213,'Close':184.907,'Mid':0.80243},
    {'Date':'2023-11-06','Open':184.674,'High':185.952,'Low':184.581,'Close':185.226,'Mid':0.80243},
    {'Date':'2023-11-07','Open':185.203,'High':185.449,'Low':184.637,'Close':184.887,'Mid':0.80243},
    {'Date':'2023-11-08','Open':184.880,'High':185.664,'Low':184.539,'Close':185.457,'Mid':0.80243},
    {'Date':'2023-11-09','Open':185.430,'High':185.883,'Low':184.835,'Close':184.973,'Mid':0.80243},
    {'Date':'2023-11-10','Open':184.992,'High':185.332,'Low':184.628,'Close':185.224,'Mid':0.80243},
    {'Date':'2023-11-13','Open':184.733,'High':186.309,'Low':184.733,'Close':186.272,'Mid':0.80243},
    {'Date':'2023-11-14','Open':186.140,'High':188.277,'Low':185.947,'Close':187.950,'Mid':0.80243},
    {'Date':'2023-11-15','Open':187.937,'High':188.267,'Low':187.180,'Close':187.928,'Mid':0.80243},
    {'Date':'2023-11-16','Open':187.785,'High':187.936,'Low':186.818,'Close':187.099,'Mid':0.80243},
    {'Date':'2023-11-17','Open':187.017,'High':187.131,'Low':185.304,'Close':186.463,'Mid':0.80243},
    {'Date':'2023-11-20','Open':186.219,'High':186.778,'Low':184.622,'Close':185.511,'Mid':0.80243},
    {'Date':'2023-11-21','Open':185.515,'High':186.087,'Low':184.454,'Close':186.053,'Mid':0.80243},
    {'Date':'2023-11-22','Open':185.876,'High':187.016,'Low':185.614,'Close':186.819,'Mid':0.80243},
    {'Date':'2023-11-23','Open':186.731,'High':187.665,'Low':186.271,'Close':187.450,'Mid':0.80243},
    {'Date':'2023-11-24','Open':187.306,'High':188.649,'Low':187.095,'Close':188.232,'Mid':0.80243},
    {'Date':'2023-11-27','Open':188.091,'High':188.516,'Low':187.589,'Close':187.716,'Mid':0.80243},
    {'Date':'2023-11-28','Open':187.726,'High':187.865,'Low':187.045,'Close':187.199,'Mid':0.80243},
    {'Date':'2023-11-29','Open':187.161,'High':187.523,'Low':186.616,'Close':186.893,'Mid':0.80243},
    {'Date':'2023-11-30','Open':186.899,'High':187.560,'Low':186.233,'Close':187.058,'Mid':0.80243},

    # ===================== 2023-12 =====================
    {'Date':'2023-12-01','Open':186.999,'High':187.517,'Low':186.190,'Close':186.577,'Mid':0.80243},
    {'Date':'2023-12-04','Open':186.015,'High':186.515,'Low':185.073,'Close':185.956,'Mid':0.80243},
    {'Date':'2023-12-05','Open':185.956,'High':186.183,'Low':185.061,'Close':185.273,'Mid':0.80243},
    {'Date':'2023-12-06','Open':185.273,'High':185.805,'Low':184.988,'Close':184.993,'Mid':0.80243},
    {'Date':'2023-12-07','Open':184.940,'High':184.990,'Low':178.600,'Close':181.476,'Mid':0.80243},
    {'Date':'2023-12-08','Open':181.414,'High':182.039,'Low':179.547,'Close':181.870,'Mid':0.80243},
    {'Date':'2023-12-11','Open':181.555,'High':184.325,'Low':181.449,'Close':183.485,'Mid':0.80243},
    {'Date':'2023-12-12','Open':183.487,'High':183.537,'Low':182.275,'Close':182.725,'Mid':0.80243},
    {'Date':'2023-12-13','Open':182.628,'High':183.139,'Low':180.194,'Close':180.282,'Mid':0.80243},
    {'Date':'2023-12-14','Open':180.251,'High':181.213,'Low':178.335,'Close':181.097,'Mid':0.80243},
    {'Date':'2023-12-15','Open':181.029,'High':181.725,'Low':179.808,'Close':180.217,'Mid':0.80243},
    {'Date':'2023-12-18','Open':180.215,'High':181.171,'Low':179.751,'Close':180.538,'Mid':0.80243},
    {'Date':'2023-12-19','Open':180.550,'High':184.175,'Low':180.016,'Close':183.090,'Mid':0.80243},
    {'Date':'2023-12-20','Open':183.004,'High':183.314,'Low':181.269,'Close':181.441,'Mid':0.80243},
    {'Date':'2023-12-21','Open':181.439,'High':181.439,'Low':179.775,'Close':180.293,'Mid':0.80243},
    {'Date':'2023-12-22','Open':180.274,'High':181.325,'Low':179.919,'Close':180.790,'Mid':0.80243},
    {'Date':'2023-12-25','Open':180.989,'High':181.063,'Low':180.941,'Close':180.974,'Mid':0.80243},
    {'Date':'2023-12-26','Open':180.521,'High':181.281,'Low':180.392,'Close':181.174,'Mid':0.80243},
    {'Date':'2023-12-27','Open':180.938,'High':182.192,'Low':180.864,'Close':181.501,'Mid':0.80243},
    {'Date':'2023-12-28','Open':181.435,'High':181.487,'Low':178.992,'Close':180.015,'Mid':0.80243},
    {'Date':'2023-12-29','Open':179.973,'High':180.533,'Low':179.303,'Close':179.516,'Mid':0.80243},

    # ===================== 2024-01 =====================
    {'Date':'2024-01-02','Open':179.156,'High':180.645,'Low':178.731,'Close':179.122,'Mid':0.80243},
    {'Date':'2024-01-03','Open':179.104,'High':181.736,'Low':178.726,'Close':181.466,'Mid':0.80243},
    {'Date':'2024-01-04','Open':181.463,'High':183.777,'Low':180.988,'Close':183.413,'Mid':0.80243},
    {'Date':'2024-01-05','Open':183.232,'High':184.327,'Low':183.158,'Close':183.908,'Mid':0.80243},
    {'Date':'2024-01-08','Open':183.724,'High':184.200,'Low':183.016,'Close':183.856,'Mid':0.80243},
    {'Date':'2024-01-09','Open':183.846,'High':183.910,'Low':182.747,'Close':183.581,'Mid':0.80243},
    {'Date':'2024-01-10','Open':183.599,'High':185.740,'Low':183.365,'Close':185.713,'Mid':0.80243},
    {'Date':'2024-01-11','Open':185.740,'High':186.160,'Low':184.899,'Close':185.302,'Mid':0.80243},
    {'Date':'2024-01-12','Open':185.137,'High':185.638,'Low':184.469,'Close':184.777,'Mid':0.80243},
    {'Date':'2024-01-15','Open':184.553,'High':185.751,'Low':184.394,'Close':185.446,'Mid':0.80243},
    {'Date':'2024-01-16','Open':185.450,'High':186.181,'Low':184.954,'Close':185.984,'Mid':0.80243},
    {'Date':'2024-01-17','Open':185.999,'High':188.117,'Low':185.671,'Close':187.805,'Mid':0.80243},
    {'Date':'2024-01-18','Open':187.804,'High':188.253,'Low':187.181,'Close':188.233,'Mid':0.80243},
    {'Date':'2024-01-19','Open':188.247,'High':188.902,'Low':187.405,'Close':188.205,'Mid':0.80243},
    {'Date':'2024-01-22','Open':188.006,'High':188.370,'Low':187.737,'Close':188.204,'Mid':0.80243},
    {'Date':'2024-01-23','Open':188.205,'High':188.898,'Low':187.331,'Close':188.175,'Mid':0.80243},
    {'Date':'2024-01-24','Open':188.184,'High':188.473,'Low':187.116,'Close':187.696,'Mid':0.80243},
    {'Date':'2024-01-25','Open':187.700,'High':188.191,'Low':187.150,'Close':187.631,'Mid':0.80243},
    {'Date':'2024-01-26','Open':187.633,'High':188.566,'Low':187.289,'Close':188.164,'Mid':0.80243},
    {'Date':'2024-01-29','Open':187.657,'High':188.270,'Low':187.110,'Close':187.432,'Mid':0.80243},
    {'Date':'2024-01-30','Open':187.451,'High':187.494,'Low':186.334,'Close':187.431,'Mid':0.80243},
    {'Date':'2024-01-31','Open':187.431,'High':187.617,'Low':185.904,'Close':186.374,'Mid':0.80243},

    # ===================== 2024-02 =====================
    {'Date':'2024-02-01','Open':186.375,'High':186.601,'Low':185.159,'Close':186.583,'Mid':0.80243},
    {'Date':'2024-02-02','Open':186.588,'High':187.729,'Low':186.243,'Close':187.404,'Mid':0.80243},
    {'Date':'2024-02-05','Open':187.341,'High':187.609,'Low':185.976,'Close':186.369,'Mid':0.80243},
    {'Date':'2024-02-06','Open':186.367,'High':186.780,'Low':186.149,'Close':186.349,'Mid':0.80243},
    {'Date':'2024-02-07','Open':186.350,'High':187.256,'Low':186.068,'Close':187.084,'Mid':0.80243},
    {'Date':'2024-02-08','Open':187.087,'High':188.465,'Low':186.774,'Close':188.394,'Mid':0.80243},
    {'Date':'2024-02-09','Open':188.396,'High':188.862,'Low':188.100,'Close':188.469,'Mid':0.80243},
    {'Date':'2024-02-12','Open':188.322,'High':188.701,'Low':187.842,'Close':188.603,'Mid':0.80243},
    {'Date':'2024-02-13','Open':188.604,'High':190.055,'Low':188.358,'Close':189.907,'Mid':0.80243},
    {'Date':'2024-02-14','Open':189.873,'High':189.873,'Low':188.743,'Close':189.192,'Mid':0.80243},
    {'Date':'2024-02-15','Open':189.181,'High':189.204,'Low':187.890,'Close':188.875,'Mid':0.80243},
    {'Date':'2024-02-16','Open':188.880,'High':189.493,'Low':188.528,'Close':189.248,'Mid':0.80243},
    {'Date':'2024-02-19','Open':189.081,'High':189.379,'Low':188.890,'Close':189.050,'Mid':0.80243},
    {'Date':'2024-02-20','Open':189.020,'High':189.714,'Low':188.821,'Close':189.335,'Mid':0.80243},
    {'Date':'2024-02-21','Open':189.330,'High':189.940,'Low':189.073,'Close':189.915,'Mid':0.80243},
    {'Date':'2024-02-22','Open':189.914,'High':190.821,'Low':189.751,'Close':190.572,'Mid':0.80243},
    {'Date':'2024-02-23','Open':190.571,'High':191.132,'Low':190.336,'Close':190.707,'Mid':0.80243},
    {'Date':'2024-02-26','Open':190.750,'High':191.309,'Low':190.309,'Close':191.157,'Mid':0.80243},
    {'Date':'2024-02-27','Open':190.990,'High':191.157,'Low':190.356,'Close':190.873,'Mid':0.80243},
    {'Date':'2024-02-28','Open':190.901,'High':190.922,'Low':190.244,'Close':190.778,'Mid':0.80243},
    {'Date':'2024-02-29','Open':190.786,'High':190.796,'Low':189.031,'Close':189.301,'Mid':0.80243},

    # ===================== 2024-03 =====================
    {'Date':'2024-03-01','Open':189.326,'High':190.384,'Low':189.011,'Close':189.914,'Mid':0.80243},
    {'Date':'2024-03-04','Open':189.850,'High':191.181,'Low':189.678,'Close':191.009,'Mid':0.80243},
    {'Date':'2024-03-05','Open':191.011,'High':191.050,'Low':190.288,'Close':190.661,'Mid':0.80243},
    {'Date':'2024-03-06','Open':190.654,'High':190.673,'Low':189.843,'Close':190.174,'Mid':0.80243},
    {'Date':'2024-03-07','Open':190.140,'High':190.173,'Low':188.217,'Close':189.613,'Mid':0.80243},
    {'Date':'2024-03-08','Open':189.608,'High':189.685,'Low':188.371,'Close':189.060,'Mid':0.80243},
    {'Date':'2024-03-11','Open':188.993,'High':189.013,'Low':187.909,'Close':188.277,'Mid':0.80243},
    {'Date':'2024-03-12','Open':188.215,'High':189.171,'Low':187.948,'Close':188.839,'Mid':0.80243},
    {'Date':'2024-03-13','Open':188.839,'High':189.544,'Low':188.408,'Close':188.905,'Mid':0.80243},
    {'Date':'2024-03-14','Open':188.913,'High':189.513,'Low':188.591,'Close':189.105,'Mid':0.80243},
    {'Date':'2024-03-15','Open':189.105,'High':190.024,'Low':188.579,'Close':189.801,'Mid':0.80243},
    {'Date':'2024-03-18','Open':189.787,'High':190.152,'Low':189.527,'Close':189.777,'Mid':0.80243},
    {'Date':'2024-03-19','Open':189.783,'High':192.159,'Low':189.620,'Close':191.792,'Mid':0.80243},
    {'Date':'2024-03-20','Open':191.792,'High':193.524,'Low':191.744,'Close':193.264,'Mid':0.80243},
    {'Date':'2024-03-21','Open':193.264,'High':193.496,'Low':191.775,'Close':191.854,'Mid':0.80243},
    {'Date':'2024-03-22','Open':191.854,'High':192.227,'Low':190.379,'Close':190.776,'Mid':0.80243},
    {'Date':'2024-03-25','Open':190.726,'High':191.567,'Low':190.335,'Close':191.299,'Mid':0.80243},
    {'Date':'2024-03-26','Open':191.299,'High':191.671,'Low':191.095,'Close':191.195,'Mid':0.80243},
    {'Date':'2024-03-27','Open':191.195,'High':191.522,'Low':190.498,'Close':191.064,'Mid':0.80243},
    {'Date':'2024-03-28','Open':191.062,'High':191.312,'Low':190.561,'Close':190.997,'Mid':0.80243},
    {'Date':'2024-03-29','Open':191.002,'High':191.229,'Low':190.771,'Close':190.990,'Mid':0.80243},

    # ===================== 2024-04 =====================
    {'Date':'2024-04-01','Open':190.820,'High':191.350,'Low':190.173,'Close':190.322,'Mid':0.80243},
    {'Date':'2024-04-02','Open':190.327,'High':190.711,'Low':190.038,'Close':190.608,'Mid':0.80243},
    {'Date':'2024-04-03','Open':190.604,'High':191.928,'Low':190.418,'Close':191.918,'Mid':0.80243},
    {'Date':'2024-04-04','Open':191.916,'High':192.243,'Low':191.007,'Close':191.318,'Mid':0.80243},
    {'Date':'2024-04-05','Open':191.317,'High':191.626,'Low':190.669,'Close':191.575,'Mid':0.80243},
    {'Date':'2024-04-08','Open':191.297,'High':192.186,'Low':191.292,'Close':192.125,'Mid':0.80243},
    {'Date':'2024-04-09','Open':192.119,'High':192.847,'Low':191.793,'Close':192.410,'Mid':0.80243},
    {'Date':'2024-04-10','Open':192.404,'High':192.924,'Low':191.466,'Close':192.049,'Mid':0.80243},
    {'Date':'2024-04-11','Open':192.065,'High':192.573,'Low':191.556,'Close':192.366,'Mid':0.80243},
    {'Date':'2024-04-12','Open':192.374,'High':192.395,'Low':189.986,'Close':190.795,'Mid':0.80243},
    {'Date':'2024-04-15','Open':190.480,'High':192.709,'Low':190.204,'Close':191.992,'Mid':0.80243},
    {'Date':'2024-04-16','Open':191.985,'High':192.806,'Low':191.642,'Close':192.226,'Mid':0.80243},
    {'Date':'2024-04-17','Open':192.228,'High':192.830,'Low':191.669,'Close':192.255,'Mid':0.80243},
    {'Date':'2024-04-18','Open':192.264,'High':192.774,'Low':191.893,'Close':192.303,'Mid':0.80243},
    {'Date':'2024-04-19','Open':192.289,'High':192.721,'Low':190.293,'Close':191.254,'Mid':0.80243},
    {'Date':'2024-04-22','Open':191.320,'High':191.693,'Low':190.316,'Close':191.220,'Mid':0.80243},
    {'Date':'2024-04-23','Open':191.222,'High':192.843,'Low':190.828,'Close':192.734,'Mid':0.80243},
    {'Date':'2024-04-24','Open':192.726,'High':193.627,'Low':192.336,'Close':193.605,'Mid':0.80243},
    {'Date':'2024-04-25','Open':193.605,'High':194.943,'Low':193.106,'Close':194.759,'Mid':0.80243},
    {'Date':'2024-04-26','Open':194.757,'High':197.905,'Low':193.958,'Close':197.812,'Mid':0.80243},
    {'Date':'2024-04-29','Open':197.030,'High':200.539,'Low':193.603,'Close':196.412,'Mid':0.80243},
    {'Date':'2024-04-30','Open':196.398,'High':197.369,'Low':195.930,'Close':197.111,'Mid':0.80243},

    # ===================== 2024-05 =====================
    {'Date':'2024-05-01','Open':196.986,'High':197.420,'Low':191.766,'Close':193.681,'Mid':0.80243},
    {'Date':'2024-05-02','Open':193.623,'High':195.744,'Low':191.850,'Close':192.624,'Mid':0.80243},
    {'Date':'2024-05-03','Open':192.549,'High':192.644,'Low':191.352,'Close':191.884,'Mid':0.80243},
    {'Date':'2024-05-06','Open':191.820,'High':193.664,'Low':191.539,'Close':193.296,'Mid':0.80243},
    {'Date':'2024-05-07','Open':193.285,'High':194.124,'Low':192.982,'Close':193.484,'Mid':0.80243},
    {'Date':'2024-05-08','Open':193.483,'High':194.510,'Low':193.012,'Close':194.379,'Mid':0.80243},
    {'Date':'2024-05-09','Open':194.373,'High':194.854,'Low':193.833,'Close':194.712,'Mid':0.80243},
    {'Date':'2024-05-10','Open':194.698,'High':195.337,'Low':194.357,'Close':195.075,'Mid':0.80243},
    {'Date':'2024-05-13','Open':194.890,'High':196.275,'Low':194.735,'Close':196.165,'Mid':0.80243},
    {'Date':'2024-05-14','Open':196.158,'High':197.051,'Low':195.713,'Close':196.944,'Mid':0.80243},
    {'Date':'2024-05-15','Open':196.916,'High':197.089,'Low':195.877,'Close':196.456,'Mid':0.80243},
    {'Date':'2024-05-16','Open':196.472,'High':196.905,'Low':195.036,'Close':196.839,'Mid':0.80243},
    {'Date':'2024-05-17','Open':196.856,'High':197.849,'Low':196.671,'Close':197.647,'Mid':0.80243},
    {'Date':'2024-05-20','Open':197.480,'High':198.639,'Low':197.253,'Close':198.522,'Mid':0.80243},
    {'Date':'2024-05-21','Open':198.503,'High':198.903,'Low':198.267,'Close':198.457,'Mid':0.80243},
    {'Date':'2024-05-22','Open':198.438,'High':199.531,'Low':198.228,'Close':199.365,'Mid':0.80243},
    {'Date':'2024-05-23','Open':199.371,'High':199.889,'Low':199.018,'Close':199.236,'Mid':0.80243},
    {'Date':'2024-05-24','Open':199.237,'High':200.062,'Low':198.906,'Close':199.892,'Mid':0.80243},
    {'Date':'2024-05-27','Open':199.870,'High':200.424,'Low':199.610,'Close':200.374,'Mid':0.80243},
    {'Date':'2024-05-28','Open':200.382,'High':200.643,'Low':200.051,'Close':200.528,'Mid':0.80243},
    {'Date':'2024-05-29','Open':200.536,'High':200.738,'Low':200.047,'Close':200.213,'Mid':0.80243},
    {'Date':'2024-05-30','Open':200.204,'High':200.235,'Low':198.749,'Close':199.605,'Mid':0.80243},
    {'Date':'2024-05-31','Open':199.642,'High':200.505,'Low':199.238,'Close':200.355,'Mid':0.80243},

    # ===================== 2024-06 =====================
    {'Date':'2024-06-03','Open':200.220,'High':200.645,'Low':199.221,'Close':199.869,'Mid':0.80243},
    {'Date':'2024-06-04','Open':199.871,'High':200.416,'Low':197.202,'Close':197.788,'Mid':0.80243},
    {'Date':'2024-06-05','Open':197.833,'High':199.746,'Low':197.482,'Close':199.562,'Mid':0.80243},
    {'Date':'2024-06-06','Open':199.543,'High':199.935,'Low':198.831,'Close':199.018,'Mid':0.80243},
    {'Date':'2024-06-07','Open':198.875,'High':199.808,'Low':198.392,'Close':199.363,'Mid':0.80243},
    {'Date':'2024-06-10','Open':199.450,'High':200.044,'Low':198.930,'Close':199.869,'Mid':0.80243},
    {'Date':'2024-06-11','Open':199.867,'High':200.392,'Low':199.625,'Close':200.175,'Mid':0.80243},
    {'Date':'2024-06-12','Open':200.168,'High':200.933,'Low':199.854,'Close':200.550,'Mid':0.80243},
    {'Date':'2024-06-13','Open':200.550,'High':201.311,'Low':199.688,'Close':200.389,'Mid':0.80243},
    {'Date':'2024-06-14','Open':200.382,'High':201.612,'Low':198.918,'Close':199.654,'Mid':0.80243},
    {'Date':'2024-06-17','Open':199.650,'High':200.449,'Low':199.058,'Close':200.378,'Mid':0.80243},
    {'Date':'2024-06-18','Open':200.343,'High':200.844,'Low':200.015,'Close':200.618,'Mid':0.80243},
    {'Date':'2024-06-19','Open':200.623,'High':201.112,'Low':200.244,'Close':201.062,'Mid':0.80243},
    {'Date':'2024-06-20','Open':201.081,'High':201.389,'Low':200.788,'Close':201.151,'Mid':0.80243},
    {'Date':'2024-06-21','Open':201.152,'High':202.044,'Low':200.449,'Close':202.003,'Mid':0.80243},
    {'Date':'2024-06-24','Open':201.899,'High':202.697,'Low':201.129,'Close':202.470,'Mid':0.80243},
    {'Date':'2024-06-25','Open':202.428,'High':202.724,'Low':201.959,'Close':202.586,'Mid':0.80243},
    {'Date':'2024-06-26','Open':202.552,'High':203.145,'Low':202.301,'Close':202.973,'Mid':0.80243},
    {'Date':'2024-06-27','Open':202.858,'High':203.382,'Low':202.501,'Close':203.176,'Mid':0.80243},
    {'Date':'2024-06-28','Open':203.189,'High':203.589,'Low':202.563,'Close':203.424,'Mid':0.80243},

    # ===================== 2024-07 =====================
    {'Date':'2024-07-01','Open':203.440,'High':204.724,'Low':203.198,'Close':204.254,'Mid':0.80243},
    {'Date':'2024-07-02','Open':204.197,'High':204.383,'Low':203.882,'Close':204.126,'Mid':0.80243},
    {'Date':'2024-07-03','Open':204.803,'High':206.164,'Low':204.421,'Close':206.042,'Mid':0.80243},
    {'Date':'2024-07-04','Open':206.032,'High':206.069,'Low':205.284,'Close':205.775,'Mid':0.80243},
    {'Date':'2024-07-05','Open':205.765,'High':206.435,'Low':204.983,'Close':206.023,'Mid':0.80243},
    {'Date':'2024-07-08','Open':205.700,'High':206.664,'Low':205.288,'Close':205.956,'Mid':0.80243},
    {'Date':'2024-07-09','Open':205.918,'High':206.582,'Low':205.828,'Close':206.281,'Mid':0.80243},
    {'Date':'2024-07-10','Open':206.268,'High':207.814,'Low':206.015,'Close':207.725,'Mid':0.80243},
    {'Date':'2024-07-11','Open':207.733,'High':208.110,'Low':203.824,'Close':205.150,'Mid':0.80243},
    {'Date':'2024-07-12','Open':205.142,'High':206.336,'Low':203.814,'Close':205.029,'Mid':0.80243},
    {'Date':'2024-07-15','Open':205.050,'High':205.397,'Low':204.133,'Close':204.998,'Mid':0.80243},
    {'Date':'2024-07-16','Open':204.902,'High':205.787,'Low':204.769,'Close':205.441,'Mid':0.80243},
    {'Date':'2024-07-17','Open':205.298,'High':205.688,'Low':203.016,'Close':203.212,'Mid':0.80243},
    {'Date':'2024-07-18','Open':203.135,'High':203.862,'Low':202.095,'Close':203.673,'Mid':0.80243},
    {'Date':'2024-07-19','Open':203.680,'High':204.217,'Low':202.945,'Close':203.288,'Mid':0.80243},
    {'Date':'2024-07-22','Open':203.037,'High':203.608,'Low':201.889,'Close':203.046,'Mid':0.80243},
    {'Date':'2024-07-23','Open':203.041,'High':203.156,'Low':200.743,'Close':200.799,'Mid':0.80243},
    {'Date':'2024-07-24','Open':200.788,'High':201.177,'Low':197.768,'Close':198.575,'Mid':0.80243},
    {'Date':'2024-07-25','Open':198.593,'High':198.796,'Low':195.860,'Close':197.833,'Mid':0.80243},
    {'Date':'2024-07-26','Open':197.849,'High':199.139,'Low':196.896,'Close':197.752,'Mid':0.80243},
    {'Date':'2024-07-29','Open':197.620,'High':198.603,'Low':196.784,'Close':198.080,'Mid':0.80243},
    {'Date':'2024-07-30','Open':198.054,'High':199.464,'Low':195.975,'Close':196.049,'Mid':0.80243},
    {'Date':'2024-07-31','Open':196.058,'High':197.545,'Low':192.163,'Close':192.800,'Mid':0.80243},

    # ===================== 2024-08 =====================
    {'Date':'2024-08-01','Open':192.794,'High':193.249,'Low':190.159,'Close':190.258,'Mid':0.80243},
    {'Date':'2024-08-02','Open':190.320,'High':190.500,'Low':187.381,'Close':187.553,'Mid':0.80243},
    {'Date':'2024-08-05','Open':187.562,'High':187.628,'Low':180.075,'Close':184.211,'Mid':0.80243},
    {'Date':'2024-08-06','Open':184.213,'High':187.070,'Low':182.803,'Close':183.134,'Mid':0.80243},
    {'Date':'2024-08-07','Open':183.131,'High':188.063,'Low':182.902,'Close':186.128,'Mid':0.80243},
    {'Date':'2024-08-08','Open':186.129,'High':187.868,'Low':184.469,'Close':187.709,'Mid':0.80243},
    {'Date':'2024-08-09','Open':187.700,'High':188.406,'Low':186.470,'Close':187.007,'Mid':0.80243},
    {'Date':'2024-08-12','Open':186.946,'High':189.321,'Low':186.896,'Close':187.915,'Mid':0.80243},
    {'Date':'2024-08-13','Open':187.914,'High':189.504,'Low':187.572,'Close':188.839,'Mid':0.80243},
    {'Date':'2024-08-14','Open':188.863,'High':189.422,'Low':187.852,'Close':189.000,'Mid':0.80243},
    {'Date':'2024-08-15','Open':188.866,'High':191.999,'Low':188.747,'Close':191.887,'Mid':0.80243},
    {'Date':'2024-08-16','Open':191.846,'High':192.001,'Low':190.367,'Close':190.975,'Mid':0.80243},
    {'Date':'2024-08-19','Open':191.002,'High':191.620,'Low':188.229,'Close':190.407,'Mid':0.80243},
    {'Date':'2024-08-20','Open':190.338,'High':191.256,'Low':189.222,'Close':189.329,'Mid':0.80243},
    {'Date':'2024-08-21','Open':189.327,'High':191.404,'Low':188.921,'Close':190.080,'Mid':0.80243},
    {'Date':'2024-08-22','Open':190.154,'High':191.912,'Low':189.625,'Close':191.474,'Mid':0.80243},
    {'Date':'2024-08-23','Open':191.458,'High':192.019,'Low':190.264,'Close':190.673,'Mid':0.80243},
    {'Date':'2024-08-26','Open':190.321,'High':190.781,'Low':189.499,'Close':190.566,'Mid':0.80243},
    {'Date':'2024-08-27','Open':190.589,'High':191.914,'Low':190.231,'Close':190.879,'Mid':0.80243},
    {'Date':'2024-08-28','Open':190.818,'High':191.442,'Low':190.348,'Close':190.697,'Mid':0.80243},
    {'Date':'2024-08-29','Open':190.722,'High':191.535,'Low':190.250,'Close':190.950,'Mid':0.80243},
    {'Date':'2024-08-30','Open':190.956,'High':192.008,'Low':190.487,'Close':191.822,'Mid':0.80243},

    # ===================== 2024-09 =====================
    {'Date':'2024-09-02','Open':191.765,'High':193.465,'Low':191.326,'Close':193.151,'Mid':0.80243},
    {'Date':'2024-09-03','Open':193.166,'High':193.351,'Low':190.313,'Close':190.764,'Mid':0.80243},
    {'Date':'2024-09-04','Open':190.737,'High':190.839,'Low':188.922,'Close':188.936,'Mid':0.80243},
    {'Date':'2024-09-05','Open':188.935,'High':189.774,'Low':188.061,'Close':189.054,'Mid':0.80243},
    {'Date':'2024-09-06','Open':188.970,'High':189.397,'Low':186.512,'Close':186.746,'Mid':0.80243},
    {'Date':'2024-09-09','Open':186.558,'High':188.121,'Low':186.407,'Close':187.177,'Mid':0.80243},
    {'Date':'2024-09-10','Open':187.189,'High':188.089,'Low':185.721,'Close':186.321,'Mid':0.80243},
    {'Date':'2024-09-11','Open':186.322,'High':186.363,'Low':183.711,'Close':185.666,'Mid':0.80243},
    {'Date':'2024-09-12','Open':185.640,'High':186.730,'Low':185.281,'Close':186.116,'Mid':0.80243},
    {'Date':'2024-09-13','Open':186.095,'High':186.198,'Low':184.362,'Close':184.739,'Mid':0.80243},
    {'Date':'2024-09-16','Open':184.658,'High':186.032,'Low':183.763,'Close':185.823,'Mid':0.80243},
    {'Date':'2024-09-17','Open':185.824,'High':187.448,'Low':185.286,'Close':187.409,'Mid':0.80243},
    {'Date':'2024-09-18','Open':187.401,'High':188.044,'Low':185.823,'Close':187.988,'Mid':0.80243},
    {'Date':'2024-09-19','Open':187.989,'High':190.383,'Low':187.416,'Close':189.445,'Mid':0.80243},
    {'Date':'2024-09-20','Open':189.439,'High':191.986,'Low':188.708,'Close':191.558,'Mid':0.80243},
    {'Date':'2024-09-23','Open':191.408,'High':192.428,'Low':190.125,'Close':191.659,'Mid':0.80243},
    {'Date':'2024-09-24','Open':191.644,'High':193.315,'Low':191.230,'Close':192.090,'Mid':0.80243},
    {'Date':'2024-09-25','Open':192.043,'High':193.254,'Low':191.770,'Close':192.851,'Mid':0.80243},
    {'Date':'2024-09-26','Open':192.844,'High':194.345,'Low':192.503,'Close':194.265,'Mid':0.80243},
    {'Date':'2024-09-27','Open':194.248,'High':195.956,'Low':189.999,'Close':190.093,'Mid':0.80243},
    {'Date':'2024-09-30','Open':190.041,'High':192.304,'Low':189.553,'Close':192.087,'Mid':0.80243},

    # ===================== 2024-10 =====================
    {'Date':'2024-10-01','Open':192.082,'High':193.352,'Low':189.846,'Close':190.723,'Mid':0.80243},
    {'Date':'2024-10-02','Open':190.719,'High':194.416,'Low':190.406,'Close':194.297,'Mid':0.80243},
    {'Date':'2024-10-03','Open':194.330,'High':195.165,'Low':192.116,'Close':192.824,'Mid':0.80243},
    {'Date':'2024-10-04','Open':192.828,'High':195.519,'Low':191.721,'Close':195.101,'Mid':0.80243},
    {'Date':'2024-10-07','Open':194.873,'High':195.616,'Low':193.338,'Close':193.861,'Mid':0.80243},
    {'Date':'2024-10-08','Open':193.832,'High':194.366,'Low':192.879,'Close':194.197,'Mid':0.80243},
    {'Date':'2024-10-09','Open':194.179,'High':195.243,'Low':193.581,'Close':195.134,'Mid':0.80243},
    {'Date':'2024-10-10','Open':195.128,'High':195.496,'Low':193.567,'Close':194.030,'Mid':0.80243},
    {'Date':'2024-10-11','Open':193.947,'High':195.230,'Low':193.738,'Close':194.778,'Mid':0.80243},
    {'Date':'2024-10-14','Open':194.544,'High':195.706,'Low':194.544,'Close':195.556,'Mid':0.80243},
    {'Date':'2024-10-15','Open':195.564,'High':195.721,'Low':194.638,'Close':195.042,'Mid':0.80243},
    {'Date':'2024-10-16','Open':195.099,'High':195.275,'Low':193.698,'Close':194.358,'Mid':0.80243},
    {'Date':'2024-10-17','Open':194.386,'High':195.595,'Low':193.825,'Close':195.399,'Mid':0.80243},
    {'Date':'2024-10-18','Open':195.302,'High':196.046,'Low':194.751,'Close':195.066,'Mid':0.80243},
    {'Date':'2024-10-21','Open':194.980,'High':195.882,'Low':194.562,'Close':195.830,'Mid':0.80243},
    {'Date':'2024-10-22','Open':195.837,'High':196.510,'Low':195.096,'Close':196.132,'Mid':0.80243},
    {'Date':'2024-10-23','Open':196.137,'High':198.425,'Low':195.688,'Close':197.373,'Mid':0.80243},
    {'Date':'2024-10-24','Open':197.370,'High':197.622,'Low':196.424,'Close':196.987,'Mid':0.80243},
    {'Date':'2024-10-25','Open':196.982,'High':197.769,'Low':196.377,'Close':197.390,'Mid':0.80243},
    {'Date':'2024-10-28','Open':198.182,'High':199.347,'Low':197.804,'Close':198.734,'Mid':0.80243},
    {'Date':'2024-10-29','Open':198.733,'High':199.706,'Low':198.032,'Close':199.455,'Mid':0.80243},
    {'Date':'2024-10-30','Open':199.454,'High':199.797,'Low':198.197,'Close':198.761,'Mid':0.80243},
    {'Date':'2024-10-31','Open':198.720,'High':198.900,'Low':195.372,'Close':196.028,'Mid':0.80243},

    # ===================== 2024-11 =====================
    {'Date':'2024-11-01','Open':196.027,'High':198.357,'Low':195.776,'Close':197.570,'Mid':0.80243},
    {'Date':'2024-11-04','Open':197.487,'High':197.792,'Low':196.491,'Close':197.100,'Mid':0.80243},
    {'Date':'2024-11-05','Open':197.102,'High':197.870,'Low':196.922,'Close':197.715,'Mid':0.80243},
    {'Date':'2024-11-06','Open':197.718,'High':199.516,'Low':197.210,'Close':199.120,'Mid':0.80243},
    {'Date':'2024-11-07','Open':199.001,'High':199.550,'Low':198.293,'Close':198.563,'Mid':0.80243},
    {'Date':'2024-11-08','Open':198.536,'High':198.913,'Low':196.732,'Close':197.173,'Mid':0.80243},
    {'Date':'2024-11-11','Open':197.036,'High':198.457,'Low':196.625,'Close':197.798,'Mid':0.80243},
    {'Date':'2024-11-12','Open':197.708,'High':198.051,'Low':196.874,'Close':197.074,'Mid':0.80243},
    {'Date':'2024-11-13','Open':196.989,'High':197.807,'Low':196.650,'Close':197.543,'Mid':0.80243},
    {'Date':'2024-11-14','Open':197.444,'High':198.234,'Low':197.071,'Close':197.892,'Mid':0.80243},
    {'Date':'2024-11-15','Open':197.883,'High':198.436,'Low':194.293,'Close':194.799,'Mid':0.80243},
    {'Date':'2024-11-18','Open':194.592,'High':196.143,'Low':194.360,'Close':196.048,'Mid':0.80243},
    {'Date':'2024-11-19','Open':196.035,'High':196.210,'Low':193.555,'Close':196.109,'Mid':0.80243},
    {'Date':'2024-11-20','Open':196.106,'High':197.777,'Low':195.898,'Close':196.554,'Mid':0.80243},
    {'Date':'2024-11-21','Open':196.578,'High':196.633,'Low':194.363,'Close':194.453,'Mid':0.80243},
    {'Date':'2024-11-22','Open':194.439,'High':194.802,'Low':192.845,'Close':193.911,'Mid':0.80243},
    {'Date':'2024-11-25','Open':194.027,'High':194.614,'Low':193.265,'Close':193.770,'Mid':0.80243},
    {'Date':'2024-11-26','Open':193.831,'High':193.831,'Low':192.033,'Close':192.415,'Mid':0.80243},
    {'Date':'2024-11-27','Open':192.417,'High':192.619,'Low':190.687,'Close':191.499,'Mid':0.80243},
    {'Date':'2024-11-28','Open':191.382,'High':192.464,'Low':191.278,'Close':192.209,'Mid':0.80243},
    {'Date':'2024-11-29','Open':192.126,'High':192.267,'Low':190.154,'Close':190.551,'Mid':0.80243},

    # ===================== 2024-12 =====================
    {'Date':'2024-12-02','Open':190.378,'High':191.282,'Low':188.465,'Close':189.243,'Mid':0.80243},
    {'Date':'2024-12-03','Open':189.241,'High':190.373,'Low':188.079,'Close':189.487,'Mid':0.80243},
    {'Date':'2024-12-04','Open':189.497,'High':191.525,'Low':189.354,'Close':191.198,'Mid':0.80243},
    {'Date':'2024-12-05','Open':191.222,'High':192.206,'Low':190.337,'Close':191.422,'Mid':0.80243},
    {'Date':'2024-12-06','Open':191.433,'High':192.364,'Low':190.718,'Close':191.182,'Mid':0.80243},
    {'Date':'2024-12-09','Open':190.941,'High':193.401,'Low':190.600,'Close':192.725,'Mid':0.80243},
    {'Date':'2024-12-10','Open':192.801,'High':194.101,'Low':192.422,'Close':193.957,'Mid':0.80243},
    {'Date':'2024-12-11','Open':193.905,'High':194.773,'Low':192.524,'Close':194.280,'Mid':0.80243},
    {'Date':'2024-12-12','Open':194.375,'High':194.993,'Low':192.930,'Close':193.335,'Mid':0.80243},
    {'Date':'2024-12-13','Open':193.431,'High':194.452,'Low':192.846,'Close':193.869,'Mid':0.80243},
    {'Date':'2024-12-16','Open':193.820,'High':195.880,'Low':193.646,'Close':195.402,'Mid':0.80243},
    {'Date':'2024-12-17','Open':195.407,'High':195.892,'Low':194.649,'Close':194.934,'Mid':0.80243},
    {'Date':'2024-12-18','Open':194.953,'High':195.760,'Low':194.070,'Close':194.573,'Mid':0.80243},
    {'Date':'2024-12-19','Open':194.544,'High':198.941,'Low':194.047,'Close':196.725,'Mid':0.80243},
    {'Date':'2024-12-20','Open':196.762,'High':197.282,'Low':195.745,'Close':196.541,'Mid':0.80243},
    {'Date':'2024-12-23','Open':196.433,'High':197.072,'Low':196.224,'Close':196.863,'Mid':0.80243},
    {'Date':'2024-12-24','Open':196.825,'High':197.622,'Low':196.590,'Close':196.848,'Mid':0.80243},
    {'Date':'2024-12-26','Open':197.274,'High':197.991,'Low':197.014,'Close':197.834,'Mid':0.80243},
    {'Date':'2024-12-27','Open':197.745,'High':198.712,'Low':197.208,'Close':198.424,'Mid':0.80243},
    {'Date':'2024-12-30','Open':198.370,'High':198.950,'Low':196.323,'Close':196.792,'Mid':0.80243},
    {'Date':'2024-12-31','Open':196.766,'High':197.190,'Low':195.737,'Close':196.607,'Mid':0.80243},

    # ===================== 2025-01 =====================
    {'Date':'2025-01-02','Open':196.687,'High':197.521,'Low':194.193,'Close':194.856,'Mid':0.80243},
    {'Date':'2025-01-03','Open':194.802,'High':195.533,'Low':194.637,'Close':195.378,'Mid':0.80243},
    {'Date':'2025-01-06','Open':195.126,'High':197.407,'Low':195.081,'Close':197.201,'Mid':0.80243},
]

############################################################################
# 2) PREP THE DATA
############################################################################

def load_full_2024_data():
    """
    Create a DataFrame from the entire train_data array (2023-01-02 -> 2025-01-02).
    We'll keep the function name 'load_full_2024_data' for consistency,
    even though it now holds data spanning 2023 -> 2025.
    """
    df = pd.DataFrame(train_data)
    df['Date'] = pd.to_datetime(df['Date'])
    df.set_index('Date', inplace=True)
    df.drop(columns=['Mid'], inplace=True)   # we don't need 'Mid'
    df.sort_index(inplace=True)
    return df

def clean_data(df):
    """
    Simple cleaning: sort, remove duplicates, drop NaN if any exist.
    """
    df.sort_index(inplace=True)
    df = df[~df.index.duplicated(keep='first')]
    df.dropna(inplace=True)
    return df

############################################################################
# 3) BUILD DATASET (multi-window, single-step)
############################################################################

def build_dataset(df, w_max=5):
    """
    We'll do single-step next-day forecasting:
      X = flattened last w days of O,H,L,C
      Y = next day's [Low, High, Close]
    We'll gather multiple windows: w=1..w_max
    Return X, Y, plus meta_info for reference.
    """
    df_np = df[['Open','High','Low','Close']].values
    dates = df.index.to_list()
    n = len(df_np)

    # We'll store all training samples in these lists.
    X_list, Y_list, info_list = [], [], []

    max_len = w_max * 4  # For w rows, each has 4 columns => O,H,L,C

    for w in range(1, w_max+1):
        for t in range(w, n):
            if t >= n:
                break
            # Flatten last w days
            window_data = df_np[t-w : t, :]  # shape (w,4)
            window_flat = window_data.flatten()

            # Pad if needed
            padded = np.zeros(max_len, dtype=float)
            start_idx = max_len - len(window_flat)
            padded[start_idx:] = window_flat

            # Next-day's O,H,L,C is day t
            future_day = df_np[t]   # shape(4,)
            day_low   = future_day[2]
            day_high  = future_day[1]
            day_close = future_day[3]
            target = np.array([day_low, day_high, day_close], dtype=float)

            # Optionally embed w as a feature
            feature = np.concatenate([padded, [float(w)]], axis=0)

            X_list.append(feature)
            Y_list.append(target)
            info_list.append((w, dates[t]))

    X = np.array(X_list, dtype=float)
    Y = np.array(Y_list, dtype=float)
    return X, Y, info_list

############################################################################
# 4) TRAIN MODEL
############################################################################

def train_model(X, Y):
    """
    Train a multi-output regressor (LinearRegression).
    """
    base = LinearRegression()
    model = MultiOutputRegressor(base)
    model.fit(X, Y)
    return model

############################################################################
# 5) PREDICT JUST THE NEXT DAY: 2025-01-03
############################################################################

def predict_next_trading_day(df, model, w_max=5):
    """
    We'll define the 'latest day' in df as 2025-01-02 (the last row).
    We gather the last w_max rows, flatten, and predict day 2025-01-03.
    """
    recent_df = df[['Open','High','Low','Close']].tail(w_max)
    arr = recent_df.values.flatten()

    max_len = w_max * 4
    padded = np.zeros(max_len, dtype=float)
    start_idx = max_len - len(arr)
    padded[start_idx:] = arr

    final_feature = np.concatenate([padded, [float(w_max)]], axis=0).reshape(1, -1)
    pred = model.predict(final_feature)[0]  # shape (3,)
    pred_low, pred_high, pred_close = pred
    return pred_low, pred_high, pred_close

############################################################################
# 6) MAIN
############################################################################

def main():
    df_2024 = load_full_2024_data()
    df_2024 = clean_data(df_2024)

    # We'll exclude the final row (2025-01-02) from training
    final_index = df_2024.index[-1]   # 2025-01-02
    df_train = df_2024.iloc[:-1].copy()
    print(f"Training on {len(df_train)} rows. Final row excluded: {final_index}")

    # Build dataset
    X, Y, info = build_dataset(df_train, w_max=5)
    print(f"Dataset shapes: X={X.shape}, Y={Y.shape}")
    print(f"Sample info last 5:\n{info[-5:]}")

    # Train
    model = train_model(X, Y)
    print("Model training complete.")

    # Predict next day => 2025-01-03
    pred_low, pred_high, pred_close = predict_next_trading_day(df_2024, model, w_max=5)
    print("\n=== PREDICTION FOR 2025-01-07 ===")
    print(f"Predicted Low:   {pred_low:.5f}")
    print(f"Predicted High:  {pred_high:.5f}")
    print(f"Predicted Close: {pred_close:.5f}")

if __name__ == "__main__":
    main()
