import pandas as pd
import numpy as np
from sklearn.multioutput import MultiOutputRegressor
from sklearn.linear_model import LinearRegression
import datetime

############################################################################
# 1) MANUAL DATA (GBP/JPY): JANUARY 1, 2024 THROUGH DECEMBER 26, 2024
# 
# We'll store each trading day's data in a list of dicts. 
# EXACTLY the same code structure as before, just replaced with GBP/JPY data
# and we'll predict for DEC 27, 2024.
############################################################################

train_data = [
    # ------------------- January 2024 -------------------
    {'Date': '2024-01-01','Open':179.4010,'Close':179.4010,'High':179.4010,'Low':179.4010,'Mid':179.4010},
    {'Date': '2024-01-02','Open':179.4000,'Close':179.1700,'High':180.6460,'Low':178.7460,'Mid':179.6960},
    {'Date': '2024-01-03','Open':179.1710,'Close':181.4710,'High':181.7550,'Low':179.0950,'Mid':180.4250},
    {'Date': '2024-01-04','Open':181.4780,'Close':183.4150,'High':183.7850,'Low':181.0210,'Mid':182.4030},
    {'Date': '2024-01-05','Open':183.4140,'Close':183.9350,'High':184.3140,'Low':183.3350,'Mid':183.8245},
    {'Date': '2024-01-08','Open':184.1070,'Close':183.8640,'High':184.2220,'Low':183.0250,'Mid':183.6235},
    {'Date': '2024-01-09','Open':183.8670,'Close':183.6410,'High':183.9330,'Low':182.7680,'Mid':183.3505},
    {'Date': '2024-01-10','Open':183.6350,'Close':185.7270,'High':185.7490,'Low':183.4170,'Mid':184.5830},
    {'Date': '2024-01-11','Open':185.7320,'Close':185.4070,'High':186.1600,'Low':185.2650,'Mid':185.7125},
    {'Date': '2024-01-12','Open':185.4040,'Close':184.7870,'High':185.6650,'Low':184.4790,'Mid':185.0720},
    {'Date': '2024-01-15','Open':184.9250,'Close':185.5550,'High':185.7490,'Low':184.7030,'Mid':185.2260},
    {'Date': '2024-01-16','Open':185.5100,'Close':185.9730,'High':186.1880,'Low':185.0140,'Mid':185.6010},
    {'Date': '2024-01-17','Open':186.0000,'Close':187.8790,'High':188.1220,'Low':185.8770,'Mid':186.9995},
    {'Date': '2024-01-18','Open':187.8120,'Close':188.2120,'High':188.2530,'Low':187.3250,'Mid':187.7890},
    {'Date': '2024-01-19','Open':188.2510,'Close':188.1870,'High':188.9100,'Low':187.4200,'Mid':188.1650},
    {'Date': '2024-01-22','Open':188.3190,'Close':188.2580,'High':188.3930,'Low':187.7700,'Mid':188.0815},
    {'Date': '2024-01-23','Open':188.2320,'Close':188.2490,'High':188.9130,'Low':187.3770,'Mid':188.1450},
    {'Date': '2024-01-24','Open':188.2450,'Close':187.6950,'High':188.4700,'Low':187.1320,'Mid':187.8010},
    {'Date': '2024-01-25','Open':187.7160,'Close':187.6960,'High':188.1920,'Low':187.1660,'Mid':187.6790},
    {'Date': '2024-01-26','Open':187.6460,'Close':188.1850,'High':188.5660,'Low':187.3390,'Mid':187.9525},
    {'Date': '2024-01-29','Open':188.1070,'Close':187.4880,'High':188.2940,'Low':187.1210,'Mid':187.7075},
    {'Date': '2024-01-30','Open':187.4580,'Close':187.4570,'High':187.5160,'Low':186.5250,'Mid':187.0205},
    {'Date': '2024-01-31','Open':187.4560,'Close':186.4380,'High':187.6120,'Low':185.9640,'Mid':186.7880},

    # ------------------- February 2024 -------------------
    {'Date': '2024-02-01','Open':186.4380,'Close':186.6000,'High':186.6580,'Low':185.2350,'Mid':185.9465},
    {'Date': '2024-02-02','Open':186.5930,'Close':187.4770,'High':187.7390,'Low':186.4460,'Mid':187.0925},
    {'Date': '2024-02-05','Open':187.6480,'Close':186.3990,'High':187.6480,'Low':186.1820,'Mid':186.9150},
    {'Date': '2024-02-06','Open':186.3830,'Close':186.3700,'High':186.7820,'Low':186.1970,'Mid':186.4895},
    {'Date': '2024-02-07','Open':186.3850,'Close':187.1170,'High':187.2640,'Low':186.1920,'Mid':186.7280},
    {'Date': '2024-02-08','Open':187.1120,'Close':188.4520,'High':188.4840,'Low':186.8770,'Mid':187.6805},
    {'Date': '2024-02-09','Open':188.3920,'Close':188.5250,'High':188.8640,'Low':188.2550,'Mid':188.5595},
    {'Date': '2024-02-12','Open':188.4780,'Close':188.5980,'High':188.7270,'Low':187.8610,'Mid':188.2940},
    {'Date': '2024-02-13','Open':188.5980,'Close':189.8850,'High':190.0780,'Low':188.4460,'Mid':189.2620},
    {'Date': '2024-02-14','Open':189.8920,'Close':189.2400,'High':189.9090,'Low':188.7610,'Mid':189.3350},
    {'Date': '2024-02-15','Open':189.2410,'Close':188.9350,'High':189.2410,'Low':188.0170,'Mid':188.6290},
    {'Date': '2024-02-16','Open':188.9150,'Close':189.2340,'High':189.5210,'Low':188.8290,'Mid':189.1750},
    {'Date': '2024-02-19','Open':189.2920,'Close':189.1040,'High':189.3910,'Low':188.9100,'Mid':189.1505},
    {'Date': '2024-02-20','Open':189.1030,'Close':189.3180,'High':189.7260,'Low':189.0400,'Mid':189.3830},
    {'Date': '2024-02-21','Open':189.3440,'Close':189.9140,'High':189.9190,'Low':189.1580,'Mid':189.5385},
    {'Date': '2024-02-22','Open':189.9520,'Close':190.5970,'High':190.8280,'Low':189.8580,'Mid':190.3430},
    {'Date': '2024-02-23','Open':190.5810,'Close':190.7350,'High':191.1480,'Low':190.4080,'Mid':190.7780},
    {'Date': '2024-02-26','Open':190.7730,'Close':191.1830,'High':191.3140,'Low':190.3430,'Mid':190.8285},
    {'Date': '2024-02-27','Open':191.1670,'Close':190.9410,'High':191.1760,'Low':190.3790,'Mid':190.7775},
    {'Date': '2024-02-28','Open':190.9270,'Close':190.8060,'High':190.9550,'Low':190.2730,'Mid':190.6140},
    {'Date': '2024-02-29','Open':190.8060,'Close':189.3400,'High':190.8060,'Low':189.0490,'Mid':189.9275},

    # ------------------- March 2024 -------------------
    {'Date': '2024-03-01','Open':189.3400,'Close':189.9950,'High':190.3960,'Low':189.2830,'Mid':189.8395},
    {'Date': '2024-03-04','Open':189.7360,'Close':191.0550,'High':191.1890,'Low':189.7350,'Mid':190.4620},
    {'Date': '2024-03-05','Open':191.0540,'Close':190.6480,'High':191.0670,'Low':190.3160,'Mid':190.6915},
    {'Date': '2024-03-06','Open':190.6430,'Close':190.2000,'High':190.6910,'Low':189.8630,'Mid':190.2770},
    {'Date': '2024-03-07','Open':190.2030,'Close':189.6300,'High':190.2110,'Low':188.2400,'Mid':189.2255},
    {'Date': '2024-03-08','Open':189.6310,'Close':189.1280,'High':189.7160,'Low':188.3920,'Mid':189.0540},
    {'Date': '2024-03-11','Open':188.7030,'Close':188.2910,'High':188.9910,'Low':187.9700,'Mid':188.4805},
    {'Date': '2024-03-12','Open':188.2920,'Close':188.9100,'High':189.2010,'Low':187.9840,'Mid':188.5925},
    {'Date': '2024-03-13','Open':188.9110,'Close':189.0840,'High':189.5450,'Low':188.4230,'Mid':188.9840},
    {'Date': '2024-03-14','Open':189.0860,'Close':189.1560,'High':189.5190,'Low':188.6020,'Mid':189.0605},
    {'Date': '2024-03-15','Open':189.1570,'Close':189.8320,'High':190.0230,'Low':188.5950,'Mid':189.3090},
    {'Date': '2024-03-18','Open':190.0300,'Close':189.8640,'High':190.1550,'Low':189.5430,'Mid':189.8490},
    {'Date': '2024-03-19','Open':189.8630,'Close':191.9160,'High':192.1710,'Low':189.6650,'Mid':190.9180},
    {'Date': '2024-03-20','Open':191.9160,'Close':193.3830,'High':193.5320,'Low':191.8180,'Mid':192.6750},
    {'Date': '2024-03-21','Open':193.3850,'Close':191.9080,'High':193.5060,'Low':191.8480,'Mid':192.6770},
    {'Date': '2024-03-22','Open':191.9080,'Close':190.8230,'High':192.2400,'Low':190.3970,'Mid':191.3185},
    {'Date': '2024-03-25','Open':191.6320,'Close':191.3360,'High':191.6320,'Low':190.3610,'Mid':190.9965},
    {'Date': '2024-03-26','Open':191.3340,'Close':191.3890,'High':191.6780,'Low':191.1090,'Mid':191.3935},
    {'Date': '2024-03-27','Open':191.3890,'Close':191.1560,'High':191.5750,'Low':190.5280,'Mid':191.0515},
    {'Date': '2024-03-28','Open':191.1570,'Close':191.0580,'High':191.3290,'Low':190.5760,'Mid':190.9525},
    {'Date': '2024-03-29','Open':191.0600,'Close':191.0340,'High':191.2210,'Low':190.7870,'Mid':191.0040},

    # ------------------- April 2024 -------------------
    {'Date': '2024-04-01','Open':191.3110,'Close':190.3400,'High':191.3550,'Low':190.1800,'Mid':190.7675},
    {'Date': '2024-04-02','Open':190.3440,'Close':190.6190,'High':190.7170,'Low':190.0520,'Mid':190.3845},
    {'Date': '2024-04-03','Open':190.6170,'Close':191.9220,'High':191.9390,'Low':190.4320,'Mid':191.1855},
    {'Date': '2024-04-04','Open':191.9240,'Close':191.3300,'High':192.2450,'Low':191.0270,'Mid':191.6360},
    {'Date': '2024-04-05','Open':191.3290,'Close':191.6240,'High':191.6350,'Low':190.6840,'Mid':191.1595},
    {'Date': '2024-04-08','Open':191.6180,'Close':192.1340,'High':192.1930,'Low':191.3750,'Mid':191.7840},
    {'Date': '2024-04-09','Open':192.1360,'Close':192.4050,'High':192.8500,'Low':192.0940,'Mid':192.4720},
    {'Date': '2024-04-10','Open':192.4030,'Close':192.0860,'High':192.8950,'Low':191.4750,'Mid':192.1850},
    {'Date': '2024-04-11','Open':192.0820,'Close':192.4030,'High':192.5860,'Low':191.5700,'Mid':192.0780},
    {'Date': '2024-04-12','Open':192.4010,'Close':190.8250,'High':192.4420,'Low':190.0020,'Mid':191.2220},
    {'Date': '2024-04-15','Open':191.0780,'Close':192.0080,'High':192.7120,'Low':190.5470,'Mid':191.6295},
    {'Date': '2024-04-16','Open':192.0090,'Close':192.2540,'High':192.8080,'Low':191.6530,'Mid':192.2305},
    {'Date': '2024-04-17','Open':192.2530,'Close':192.2640,'High':192.8350,'Low':191.6870,'Mid':192.2610},
    {'Date': '2024-04-18','Open':192.2650,'Close':192.3210,'High':192.7890,'Low':191.9140,'Mid':192.3515},
    {'Date': '2024-04-19','Open':192.3210,'Close':191.2940,'High':192.7270,'Low':190.3090,'Mid':191.5180},
    {'Date': '2024-04-22','Open':191.7640,'Close':191.2090,'High':191.7640,'Low':190.3280,'Mid':191.0460},
    {'Date': '2024-04-23','Open':191.2060,'Close':192.7500,'High':192.8550,'Low':190.8340,'Mid':191.8445},
    {'Date': '2024-04-24','Open':192.7520,'Close':193.6230,'High':193.6440,'Low':192.4160,'Mid':193.0300},
    {'Date': '2024-04-25','Open':193.6230,'Close':194.7800,'High':194.9450,'Low':193.3620,'Mid':194.1535},
    {'Date': '2024-04-26','Open':194.7810,'Close':197.8260,'High':197.9260,'Low':193.9840,'Mid':195.9550},
    {'Date': '2024-04-29','Open':198.0030,'Close':196.3990,'High':200.5100,'Low':193.6330,'Mid':197.0715},
    {'Date': '2024-04-30','Open':196.3980,'Close':197.1240,'High':197.3710,'Low':196.0890,'Mid':196.7300},

    # ------------------- May 2024 -------------------
    {'Date': '2024-05-01','Open':197.1230,'Close':193.5820,'High':197.4250,'Low':191.8640,'Mid':194.6445},
    {'Date': '2024-05-02','Open':193.5790,'Close':192.5540,'High':195.7540,'Low':191.8670,'Mid':193.8105},
    {'Date': '2024-05-03','Open':192.5510,'Close':191.9470,'High':192.6970,'Low':191.3740,'Mid':192.0355},
    {'Date': '2024-05-06','Open':192.0640,'Close':193.3490,'High':193.6710,'Low':191.7930,'Mid':192.7320},
    {'Date': '2024-05-07','Open':193.3480,'Close':193.4960,'High':194.1370,'Low':192.9940,'Mid':193.5655},
    {'Date': '2024-05-08','Open':193.4970,'Close':194.3790,'High':194.5150,'Low':193.3650,'Mid':193.9400},
    {'Date': '2024-05-09','Open':194.3730,'Close':194.7130,'High':194.8630,'Low':193.8660,'Mid':194.3645},
    {'Date': '2024-05-10','Open':194.7190,'Close':195.1110,'High':195.3440,'Low':194.4860,'Mid':194.9150},
    {'Date': '2024-05-13','Open':194.9610,'Close':196.1920,'High':196.2780,'Low':194.7870,'Mid':195.5325},
    {'Date': '2024-05-14','Open':196.1910,'Close':196.9660,'High':197.0580,'Low':195.7270,'Mid':196.3925},
    {'Date': '2024-05-15','Open':196.9650,'Close':196.4810,'High':197.0920,'Low':195.9500,'Mid':196.5210},
    {'Date': '2024-05-16','Open':196.4820,'Close':196.8750,'High':196.9160,'Low':195.0530,'Mid':195.9845},
    {'Date': '2024-05-17','Open':196.8740,'Close':197.7160,'High':197.8610,'Low':196.8030,'Mid':197.3320},
    {'Date': '2024-05-20','Open':197.7410,'Close':198.5490,'High':198.6450,'Low':197.3920,'Mid':198.0185},
    {'Date': '2024-05-21','Open':198.5480,'Close':198.4780,'High':198.9080,'Low':198.2750,'Mid':198.5915},
    {'Date': '2024-05-22','Open':198.4770,'Close':199.3980,'High':199.5380,'Low':198.3840,'Mid':198.9610},
    {'Date': '2024-05-23','Open':199.3970,'Close':199.2850,'High':199.8940,'Low':199.0270,'Mid':199.4605},
    {'Date': '2024-05-24','Open':199.2810,'Close':199.9590,'High':200.0810,'Low':199.0710,'Mid':199.5760},
    {'Date': '2024-05-27','Open':200.0150,'Close':200.3200,'High':200.4360,'Low':199.6220,'Mid':200.0290},
    {'Date': '2024-05-28','Open':200.3200,'Close':200.5730,'High':200.6490,'Low':200.1610,'Mid':200.4050},
    {'Date': '2024-05-29','Open':200.5700,'Close':200.2050,'High':200.7450,'Low':200.0510,'Mid':200.3980},
    {'Date': '2024-05-30','Open':200.2100,'Close':199.6790,'High':200.2570,'Low':198.7580,'Mid':199.5075},
    {'Date': '2024-05-31','Open':199.6840,'Close':200.4520,'High':200.5140,'Low':199.2410,'Mid':199.8775},

    # ------------------- June 2024 -------------------
    {'Date': '2024-06-03','Open':200.4290,'Close':199.8980,'High':200.6530,'Low':199.2300,'Mid':199.9415},
    {'Date': '2024-06-04','Open':199.8970,'Close':197.7940,'High':200.4190,'Low':197.2060,'Mid':198.8125},
    {'Date': '2024-06-05','Open':197.7960,'Close':199.6120,'High':199.7500,'Low':197.6890,'Mid':198.7195},
    {'Date': '2024-06-06','Open':199.6110,'Close':199.0300,'High':199.9370,'Low':198.8420,'Mid':199.3895},
    {'Date': '2024-06-07','Open':199.0290,'Close':199.3780,'High':199.8120,'Low':198.4030,'Mid':199.1075},
    {'Date': '2024-06-10','Open':199.2970,'Close':199.9120,'High':200.0500,'Low':198.9380,'Mid':199.4940},
    {'Date': '2024-06-11','Open':199.9130,'Close':200.1850,'High':200.3920,'Low':199.6890,'Mid':200.0405},
    {'Date': '2024-06-12','Open':200.1840,'Close':200.5800,'High':200.9380,'Low':199.9530,'Mid':200.4455},
    {'Date': '2024-06-13','Open':200.5820,'Close':200.4200,'High':201.3170,'Low':199.7070,'Mid':200.5120},
    {'Date': '2024-06-14','Open':200.4140,'Close':199.6710,'High':201.6180,'Low':198.9300,'Mid':200.2740},
    {'Date': '2024-06-17','Open':199.7240,'Close':200.4020,'High':200.4560,'Low':199.0690,'Mid':199.7625},
    {'Date': '2024-06-18','Open':200.4010,'Close':200.6130,'High':200.8430,'Low':200.0270,'Mid':200.4350},
    {'Date': '2024-06-19','Open':200.6120,'Close':201.1080,'High':201.1220,'Low':200.4200,'Mid':200.7710},
    {'Date': '2024-06-20','Open':201.1100,'Close':201.1540,'High':201.3920,'Low':200.8230,'Mid':201.1075},
    {'Date': '2024-06-21','Open':201.1540,'Close':202.0350,'High':202.0560,'Low':200.5200,'Mid':201.2880},
    {'Date': '2024-06-24','Open':201.9330,'Close':202.4970,'High':202.7000,'Low':201.1740,'Mid':201.9370},
    {'Date': '2024-06-25','Open':202.4980,'Close':202.5920,'High':202.7310,'Low':201.9770,'Mid':202.3540},
    {'Date': '2024-06-26','Open':202.5920,'Close':202.9640,'High':203.1510,'Low':202.4290,'Mid':202.7900},
    {'Date': '2024-06-27','Open':202.9640,'Close':203.2150,'High':203.3880,'Low':202.5150,'Mid':202.9515},
    {'Date': '2024-06-28','Open':203.2150,'Close':203.4440,'High':203.5800,'Low':202.5750,'Mid':203.0775},

    # ------------------- July 2024 -------------------
    {'Date': '2024-07-01','Open':203.1470,'Close':204.2620,'High':204.7410,'Low':203.1470,'Mid':203.9440},
    {'Date': '2024-07-02','Open':204.2600,'Close':204.7910,'High':204.8580,'Low':203.8860,'Mid':204.3720},
    {'Date': '2024-07-03','Open':204.7890,'Close':206.0470,'High':206.1680,'Low':204.6710,'Mid':205.4195},
    {'Date': '2024-07-04','Open':206.0450,'Close':205.7660,'High':206.1140,'Low':205.2970,'Mid':205.7055},
    {'Date': '2024-07-05','Open':205.7660,'Close':206.0460,'High':206.4420,'Low':204.9910,'Mid':205.7165},
    {'Date': '2024-07-08','Open':205.6170,'Close':205.9750,'High':206.6680,'Low':205.3010,'Mid':205.9845},
    {'Date': '2024-07-09','Open':205.9610,'Close':206.2640,'High':206.5820,'Low':205.8680,'Mid':206.2250},
    {'Date': '2024-07-10','Open':206.2640,'Close':207.7610,'High':207.8180,'Low':206.1720,'Mid':206.9950},
    {'Date': '2024-07-11','Open':207.7600,'Close':205.1970,'High':208.1130,'Low':203.8450,'Mid':205.9790},
    {'Date': '2024-07-12','Open':205.1930,'Close':205.0890,'High':206.3390,'Low':203.8590,'Mid':205.0990},
    {'Date': '2024-07-15','Open':204.7950,'Close':205.0190,'High':205.3980,'Low':204.1600,'Mid':204.7790},
    {'Date': '2024-07-16','Open':205.0140,'Close':205.4870,'High':205.7910,'Low':204.8980,'Mid':205.3445},
    {'Date': '2024-07-17','Open':205.4840,'Close':203.2150,'High':205.6920,'Low':203.0270,'Mid':204.3595},
    {'Date': '2024-07-18','Open':203.2120,'Close':203.6950,'High':203.8680,'Low':202.1120,'Mid':202.9900},
    {'Date': '2024-07-19','Open':203.6960,'Close':203.3750,'High':204.2230,'Low':202.9560,'Mid':203.5895},
    {'Date': '2024-07-22','Open':203.3730,'Close':203.1280,'High':203.6140,'Low':201.9100,'Mid':202.7620},
    {'Date': '2024-07-23','Open':203.1250,'Close':200.8130,'High':203.1630,'Low':200.7500,'Mid':201.9565},
    {'Date': '2024-07-24','Open':200.8140,'Close':198.6050,'High':201.1830,'Low':197.7840,'Mid':199.4835},
    {'Date': '2024-07-25','Open':198.6070,'Close':197.8120,'High':198.8060,'Low':195.8730,'Mid':197.3395},
    {'Date': '2024-07-26','Open':197.8120,'Close':197.8590,'High':199.1440,'Low':196.9390,'Mid':198.0415},
    {'Date': '2024-07-29','Open':197.3940,'Close':198.1030,'High':198.6110,'Low':196.7880,'Mid':197.6995},
    {'Date': '2024-07-30','Open':198.1000,'Close':196.0770,'High':199.4680,'Low':195.9810,'Mid':197.7245},
    {'Date': '2024-07-31','Open':196.0800,'Close':192.8160,'High':197.5630,'Low':192.1980,'Mid':194.8805},

    # ------------------- August 2024 -------------------
    {'Date': '2024-08-01','Open':192.8170,'Close':190.2590,'High':193.2620,'Low':190.1860,'Mid':191.7240},
    {'Date': '2024-08-02','Open':190.2600,'Close':187.6270,'High':190.5060,'Low':187.3930,'Mid':188.9495},
    {'Date': '2024-08-05','Open':187.6970,'Close':184.2150,'High':187.6970,'Low':180.1180,'Mid':183.9075},
    {'Date': '2024-08-06','Open':184.2140,'Close':183.1920,'High':187.0610,'Low':182.8170,'Mid':184.9390},
    {'Date': '2024-08-07','Open':183.1910,'Close':186.2220,'High':188.0460,'Low':183.1540,'Mid':185.6000},
    {'Date': '2024-08-08','Open':186.2190,'Close':187.7580,'High':187.8730,'Low':184.4910,'Mid':186.1820},
    {'Date': '2024-08-09','Open':187.7520,'Close':187.0690,'High':188.4140,'Low':186.4840,'Mid':187.4490},
    {'Date': '2024-08-12','Open':187.5320,'Close':187.9040,'High':189.3300,'Low':187.1670,'Mid':188.2485},
    {'Date': '2024-08-13','Open':187.9120,'Close':188.8730,'High':189.5130,'Low':187.5930,'Mid':188.5530},
    {'Date': '2024-08-14','Open':188.8750,'Close':188.9890,'High':189.4300,'Low':187.8710,'Mid':188.6505},
    {'Date': '2024-08-15','Open':188.9910,'Close':191.9130,'High':192.0070,'Low':188.7640,'Mid':190.3855},
    {'Date': '2024-08-16','Open':191.9140,'Close':191.0780,'High':192.0100,'Low':190.3850,'Mid':191.1975},
    {'Date': '2024-08-19','Open':190.8760,'Close':190.4390,'High':191.6280,'Low':188.2490,'Mid':189.9385},
    {'Date': '2024-08-20','Open':190.4380,'Close':189.3400,'High':191.2600,'Low':189.2340,'Mid':190.2470},
    {'Date': '2024-08-21','Open':189.3400,'Close':190.1600,'High':191.4190,'Low':188.9570,'Mid':190.1880},
    {'Date': '2024-08-22','Open':190.1600,'Close':191.5330,'High':191.9430,'Low':189.6660,'Mid':190.8045},
    {'Date': '2024-08-23','Open':191.5320,'Close':190.8080,'High':192.0390,'Low':190.2860,'Mid':191.1625},
    {'Date': '2024-08-26','Open':190.9110,'Close':190.5930,'High':190.9110,'Low':189.5160,'Mid':190.2135},
    {'Date': '2024-08-27','Open':190.5930,'Close':190.9050,'High':191.9200,'Low':190.2520,'Mid':191.0860},
    {'Date': '2024-08-28','Open':190.9040,'Close':190.7260,'High':191.4450,'Low':190.3680,'Mid':190.9065},
    {'Date': '2024-08-29','Open':190.7280,'Close':190.9240,'High':191.5440,'Low':190.2650,'Mid':190.9045},
    {'Date': '2024-08-30','Open':190.9250,'Close':191.8870,'High':192.0160,'Low':190.5000,'Mid':191.2580},

    # ------------------- September 2024 -------------------
    {'Date': '2024-09-02','Open':192.1280,'Close':193.1570,'High':193.4750,'Low':191.3480,'Mid':192.4115},
    {'Date': '2024-09-03','Open':193.1510,'Close':190.7810,'High':193.3600,'Low':190.3480,'Mid':191.8540},
    {'Date': '2024-09-04','Open':190.7790,'Close':188.9890,'High':190.8590,'Low':188.9440,'Mid':189.9015},
    {'Date': '2024-09-05','Open':188.9860,'Close':189.0680,'High':189.7760,'Low':188.0780,'Mid':188.9270},
    {'Date': '2024-09-06','Open':189.0670,'Close':186.8450,'High':189.3760,'Low':186.5390,'Mid':187.9575},
    {'Date': '2024-09-09','Open':186.9860,'Close':187.1800,'High':188.1280,'Low':186.4730,'Mid':187.3005},
    {'Date': '2024-09-10','Open':187.1790,'Close':186.3350,'High':188.0930,'Low':185.7350,'Mid':186.9140},
    {'Date': '2024-09-11','Open':186.3360,'Close':185.6850,'High':186.3700,'Low':183.7320,'Mid':185.0510},
    {'Date': '2024-09-12','Open':185.6840,'Close':186.1200,'High':186.7330,'Low':185.2960,'Mid':186.0145},
    {'Date': '2024-09-13','Open':186.1200,'Close':184.8280,'High':186.2050,'Low':184.3740,'Mid':185.2895},
    {'Date': '2024-09-16','Open':185.0900,'Close':185.8450,'High':186.0440,'Low':183.7920,'Mid':184.9180},
    {'Date': '2024-09-17','Open':185.8450,'Close':187.4190,'High':187.4540,'Low':185.3000,'Mid':186.3770},
    {'Date': '2024-09-18','Open':187.4190,'Close':187.9960,'High':188.0520,'Low':185.8370,'Mid':186.9445},
    {'Date': '2024-09-19','Open':187.9950,'Close':189.4570,'High':190.3880,'Low':187.4600,'Mid':188.9240},
    {'Date': '2024-09-20','Open':189.4580,'Close':191.7200,'High':191.9880,'Low':188.7500,'Mid':190.3690},
    {'Date': '2024-09-23','Open':191.6130,'Close':191.6900,'High':192.4330,'Low':190.1450,'Mid':191.2890},
    {'Date': '2024-09-24','Open':191.6870,'Close':192.1180,'High':193.3230,'Low':191.3490,'Mid':192.3360},
    {'Date': '2024-09-25','Open':192.1140,'Close':192.8590,'High':193.2590,'Low':191.8030,'Mid':192.5310},
    {'Date': '2024-09-26','Open':192.8600,'Close':194.2610,'High':194.3540,'Low':192.5190,'Mid':193.4365},
    {'Date': '2024-09-27','Open':194.2630,'Close':190.1680,'High':195.9580,'Low':190.0210,'Mid':192.9895},
    {'Date': '2024-09-30','Open':190.0740,'Close':192.1080,'High':192.3090,'Low':189.5800,'Mid':190.9445},

    # ------------------- October 2024 -------------------
    {'Date': '2024-10-01','Open':192.1090,'Close':190.7290,'High':193.3630,'Low':189.8720,'Mid':191.6175},
    {'Date': '2024-10-02','Open':190.7300,'Close':194.3210,'High':194.4280,'Low':190.4270,'Mid':192.4275},
    {'Date': '2024-10-03','Open':194.3210,'Close':192.8490,'High':195.1710,'Low':192.1460,'Mid':193.6585},
    {'Date': '2024-10-04','Open':192.8500,'Close':195.1590,'High':195.5320,'Low':191.7480,'Mid':193.6400},
    {'Date': '2024-10-07','Open':195.1640,'Close':193.8770,'High':195.6170,'Low':193.3500,'Mid':194.4835},
    {'Date': '2024-10-08','Open':193.8750,'Close':194.2110,'High':194.3640,'Low':192.9010,'Mid':193.6325},
    {'Date': '2024-10-09','Open':194.2090,'Close':195.1680,'High':195.2530,'Low':193.6070,'Mid':194.4300},
    {'Date': '2024-10-10','Open':195.1690,'Close':194.0330,'High':195.5030,'Low':193.5910,'Mid':194.5470},
    {'Date': '2024-10-11','Open':194.0320,'Close':194.8730,'High':195.2280,'Low':193.8720,'Mid':194.5500},
    {'Date': '2024-10-14','Open':194.9310,'Close':195.5760,'High':195.7150,'Low':194.6360,'Mid':195.1755},
    {'Date': '2024-10-15','Open':195.5770,'Close':195.0780,'High':195.7260,'Low':194.6540,'Mid':195.1900},
    {'Date': '2024-10-16','Open':195.0760,'Close':194.3790,'High':195.2840,'Low':193.7130,'Mid':194.4985},
    {'Date': '2024-10-17','Open':194.3780,'Close':195.4520,'High':195.6040,'Low':193.8490,'Mid':194.7265},
    {'Date': '2024-10-18','Open':195.4530,'Close':195.1540,'High':196.0480,'Low':194.7600,'Mid':195.4040},
    {'Date': '2024-10-21','Open':195.3770,'Close':195.8700,'High':195.8930,'Low':194.5760,'Mid':195.2345},
    {'Date': '2024-10-22','Open':195.8700,'Close':196.1820,'High':196.5190,'Low':195.1180,'Mid':195.8185},
    {'Date': '2024-10-23','Open':196.1810,'Close':197.3840,'High':198.4350,'Low':196.0550,'Mid':197.2450},
    {'Date': '2024-10-24','Open':197.3850,'Close':197.0120,'High':197.6320,'Low':196.4340,'Mid':197.0330},
    {'Date': '2024-10-25','Open':197.0140,'Close':197.4180,'High':197.7700,'Low':196.4110,'Mid':197.0905},
    {'Date': '2024-10-28','Open':198.6360,'Close':198.8370,'High':199.3430,'Low':197.8190,'Mid':198.5810},
    {'Date': '2024-10-29','Open':198.8370,'Close':199.6050,'High':199.7160,'Low':198.0460,'Mid':198.8810},
    {'Date': '2024-10-30','Open':199.6050,'Close':198.8690,'High':199.7970,'Low':198.2060,'Mid':199.0015},
    {'Date': '2024-10-31','Open':198.8700,'Close':196.1090,'High':198.9000,'Low':195.3830,'Mid':197.1415},

    # ------------------- November 2024 -------------------
    {'Date': '2024-11-01','Open':196.1100,'Close':197.6420,'High':198.3640,'Low':195.7930,'Mid':197.0785},
    {'Date': '2024-11-04','Open':197.3370,'Close':197.1200,'High':197.7320,'Low':196.5100,'Mid':197.1210},
    {'Date': '2024-11-05','Open':197.1190,'Close':197.7440,'High':197.8770,'Low':197.0230,'Mid':197.4500},
    {'Date': '2024-11-06','Open':197.7460,'Close':199.1650,'High':199.5240,'Low':197.3740,'Mid':198.4490},
    {'Date': '2024-11-07','Open':199.1650,'Close':198.6200,'High':199.5610,'Low':198.3340,'Mid':198.9475},
    {'Date': '2024-11-08','Open':198.6190,'Close':197.2010,'High':198.9200,'Low':196.7550,'Mid':197.8375},
    {'Date': '2024-11-11','Open':197.2930,'Close':197.8120,'High':198.4620,'Low':197.1680,'Mid':197.8150},
    {'Date': '2024-11-12','Open':197.8110,'Close':197.0990,'High':198.0610,'Low':196.8870,'Mid':197.4740},
    {'Date': '2024-11-13','Open':197.0980,'Close':197.5780,'High':197.8140,'Low':196.6720,'Mid':197.2430},
    {'Date': '2024-11-14','Open':197.5750,'Close':197.9430,'High':198.2400,'Low':197.0920,'Mid':197.6660},
    {'Date': '2024-11-15','Open':197.9420,'Close':194.8100,'High':198.4500,'Low':194.3050,'Mid':196.3775},
    {'Date': '2024-11-18','Open':194.6220,'Close':196.1060,'High':196.1510,'Low':194.3920,'Mid':195.2715},
    {'Date': '2024-11-19','Open':196.1040,'Close':196.1380,'High':196.2160,'Low':193.5770,'Mid':194.8965},
    {'Date': '2024-11-20','Open':196.1390,'Close':196.6680,'High':197.7840,'Low':195.9720,'Mid':196.8780},
    {'Date': '2024-11-21','Open':196.6690,'Close':194.5550,'High':196.6760,'Low':194.3810,'Mid':195.5285},
    {'Date': '2024-11-22','Open':194.5560,'Close':193.9580,'High':194.8110,'Low':192.8570,'Mid':193.8340},
    {'Date': '2024-11-25','Open':193.7910,'Close':193.7880,'High':194.6180,'Low':193.2860,'Mid':193.9520},
    {'Date': '2024-11-26','Open':193.7890,'Close':192.4300,'High':193.9120,'Low':192.0460,'Mid':192.9790},
    {'Date': '2024-11-27','Open':192.4280,'Close':191.6050,'High':192.6250,'Low':190.7030,'Mid':191.6640},
    {'Date': '2024-11-28','Open':191.6030,'Close':192.2710,'High':192.4730,'Low':191.3960,'Mid':191.9345},
    {'Date': '2024-11-29','Open':192.2700,'Close':190.7110,'High':192.3170,'Low':190.1650,'Mid':191.2410},

    # ------------------- December 2024 (Partial, up to 26th) -------------------
    {'Date': '2024-12-02','Open':190.7220,'Close':189.3090,'High':191.2900,'Low':188.4870,'Mid':189.8885},
    {'Date': '2024-12-03','Open':189.3090,'Close':189.5810,'High':190.3740,'Low':188.1050,'Mid':189.2395},
    {'Date': '2024-12-04','Open':189.5840,'Close':191.2850,'High':191.5250,'Low':189.3690,'Mid':190.4470},
    {'Date': '2024-12-05','Open':191.2850,'Close':191.5020,'High':192.2130,'Low':190.3450,'Mid':191.2790},
    {'Date': '2024-12-06','Open':191.5030,'Close':191.1770,'High':192.3720,'Low':190.7350,'Mid':191.5535},
    {'Date': '2024-12-09','Open':191.3500,'Close':192.8040,'High':193.4140,'Low':190.6120,'Mid':192.0130},
    {'Date': '2024-12-10','Open':192.8040,'Close':194.0850,'High':194.1200,'Low':192.4660,'Mid':193.2930},
    {'Date': '2024-12-11','Open':194.0830,'Close':194.4070,'High':194.7560,'Low':192.5550,'Mid':193.6555},
    {'Date': '2024-12-12','Open':194.4060,'Close':193.4450,'High':194.9960,'Low':192.9420,'Mid':193.9690},
    {'Date': '2024-12-13','Open':193.4470,'Close':193.8980,'High':194.4570,'Low':192.8660,'Mid':193.6615},
    {'Date': '2024-12-16','Open':194.3850,'Close':195.5220,'High':195.8800,'Low':193.6660,'Mid':194.7730},
]

############################################################################
# 2) CREATE DATAFRAME & SINGLE-STEP MULTI-WINDOW APPROACH
#    (Same code structure as before, just replaced with GBP/JPY data)
############################################################################

def load_5months_data():
    """
    Actually loads nearly a full year of GBP/JPY data (Jan 1 to Dec 26, 2024).
    We'll keep the function name for consistency with previous examples.
    """
    df = pd.DataFrame(train_data)
    df['Date'] = pd.to_datetime(df['Date'])
    df.set_index('Date', inplace=True)
    # We'll keep columns: [Open, High, Low, Close] and drop 'Mid'.
    df.drop(columns=['Mid'], inplace=True)
    df.sort_index(inplace=True)
    return df

def clean_data(df):
    """
    Sort, remove duplicates, drop any NaN if found.
    """
    df.sort_index(inplace=True)
    df = df[~df.index.duplicated(keep='first')]
    df.dropna(inplace=True)
    return df

def build_dataset(df, w_max=5):
    """
    We'll do a single-step next-day approach (H=1).
    We'll do multi-window (w=1..w_max).
    Flatten each window of size w (for columns O,H,L,C).
    Output = [Low, High, Close] for the next day => shape=(3,).
    """
    df_np = df[['Open','High','Low','Close']].values
    dates = df.index.to_list()
    n = len(df_np)

    X_list = []
    Y_list = []
    info_list = []

    max_window_dim = w_max * 4  # 4 columns => O,H,L,C

    for w in range(1, w_max+1):
        for t in range(w, n-1):
            # window_data shape => (w,4)
            window_data = df_np[t-w : t, :]
            window_flat = window_data.flatten()

            # pad to w_max*4 with zeros at the front if needed
            window_padded = np.zeros(max_window_dim, dtype=float)
            start_idx = max_window_dim - len(window_flat)
            window_padded[start_idx:] = window_flat

            # Next day's row => index t
            future_day = df_np[t]
            # future_day = [Open,High,Low,Close]
            day_low  = future_day[2]
            day_high = future_day[1]
            day_close= future_day[3]
            out_arr = np.array([day_low, day_high, day_close], dtype=float)

            # We'll embed w as a feature
            feature = np.concatenate([window_padded, [float(w)]])
            X_list.append(feature)
            Y_list.append(out_arr)
            info_list.append((w, t, dates[t]))  # e.g. (window_size, index, date)

    X = np.array(X_list, dtype=float)
    Y = np.array(Y_list, dtype=float)
    return X, Y, info_list

def train_model(X, Y):
    """
    Fit a MultiOutputRegressor(LinearRegression) for [Low,High,Close].
    """
    model = MultiOutputRegressor(LinearRegression())
    model.fit(X, Y)
    return model

def predict_december(df, model, w_max=5):
    """
    We'll predict specifically for 2024-12-27 
    (the day after the last known data: 2024-12-26).
    EXACT code structure as previous examples; just one day range.
    """
    df_extended = df.copy()

    # We'll define one business day: dec 27
    start_dec = pd.to_datetime("2024-12-27")
    end_dec   = pd.to_datetime("2024-12-27")
    all_dates = pd.date_range(start_dec, end_dec, freq='B')  # just dec 27

    predictions = []
    for day in all_dates:
        # gather last w_max rows from df_extended
        recent_df = df_extended[['Open','High','Low','Close']].tail(w_max)
        arr = recent_df.values.flatten()

        window_dim = w_max*4
        window_padded = np.zeros(window_dim, dtype=float)
        start_idx = window_dim - len(arr)
        window_padded[start_idx:] = arr

        # embed w = w_max
        feature = np.concatenate([window_padded, [float(w_max)]])
        pred = model.predict(feature.reshape(1, -1))[0]
        pred_low, pred_high, pred_close = pred

        # guess new day's Open = prior day's Close
        last_real_close = df_extended.iloc[-1]['Close']
        new_open = last_real_close

        # create a row for dec 27
        new_row = pd.DataFrame({
            'Open':  [new_open],
            'High':  [pred_high],
            'Low':   [pred_low],
            'Close': [pred_close]
        }, index=[day])
        df_extended = pd.concat([df_extended, new_row])

        predictions.append({
            'Date': day.strftime('%Y-%m-%d'),
            'Predicted_Low':   pred_low,
            'Predicted_High':  pred_high,
            'Predicted_Close': pred_close
        })

    return pd.DataFrame(predictions)

############################################################################
# 3) MAIN
############################################################################
def main():
    # 1) Load data (Jan 1 to Dec 26, 2024 for GBP/JPY)
    df_5mo = load_5months_data()
    df_5mo = clean_data(df_5mo)
    print("\nGBP/JPY DATA (Jan 1 thru Dec 26, 2024)\n", df_5mo.head(5), "...\n")

    # 2) Build dataset
    X, Y, info = build_dataset(df_5mo, w_max=5)
    print(f"Dataset shape: X={X.shape}, Y={Y.shape}")

    # 3) Train the model
    model = train_model(X, Y)
    print("Model trained on Jan 1 - Dec 26 data.\n")

    # 4) Predict specifically for 2024-12-27
    pred_df = predict_december(df_5mo, model, w_max=5)
    print("=== PREDICTION FOR 2024-12-27 ===")
    if not pred_df.empty:
        row = pred_df.iloc[0]
        print(f"Predicted Low:   {row['Predicted_Low']:.5f}")
        print(f"Predicted High:  {row['Predicted_High']:.5f}")
        print(f"Predicted Close: {row['Predicted_Close']:.5f}")
    else:
        print("No prediction generated. (Check data range)")

if __name__ == "__main__":
    main()
